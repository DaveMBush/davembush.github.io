<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Test Driven Development Kata - Roman to Arabic in JavaScript | Dave&#39;s Notebook</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Coding Katas are a way of developing your skills as a programmer.  I thought it might be informative to tackle one of the classics as a blog post. Depending on how this works, I may or may not do anot">
<meta property="og:type" content="article">
<meta property="og:title" content="Test Driven Development Kata - Roman to Arabic in JavaScript">
<meta property="og:url" content="http://davembush.github.com/test-driven-development-kata-roman-to-arabic-in-javascript/index.html">
<meta property="og:site_name" content="Dave&#39;s Notebook">
<meta property="og:description" content="Coding Katas are a way of developing your skills as a programmer.  I thought it might be informative to tackle one of the classics as a blog post. Depending on how this works, I may or may not do anot">
<meta property="og:locale">
<meta property="og:image" content="http://davembush.github.com/uploads/2016/07/image-3.png">
<meta property="article:published_time" content="2016-07-20T10:30:00.000Z">
<meta property="article:modified_time" content="2020-01-20T15:13:02.000Z">
<meta property="article:author" content="Dave M Bush">
<meta property="article:tag" content="tdd">
<meta property="article:tag" content="javascript">
<meta property="article:tag" content="kata">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://davembush.github.com/uploads/2016/07/image-3.png">
  
    <link rel="alternate" href="/atom.xml" title="Dave&#39;s Notebook" type="application/atom+xml">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" integrity="sha384-XdYbMnZ/QjLh6iI4ogqCTaIjrFk87ip+ekIjefZch0Y+PvJ8CDYtEs1ipDmPorQ+" crossorigin="anonymous">

  
<link rel="stylesheet" href="/css/styles.css">

  

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <nav class="navbar navbar-inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#main-menu-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="main-menu-navbar">
      <ul class="nav navbar-nav">
        
          <li><a class=""
                 href="/index.html">Home</a></li>
        
          <li><a class=""
                 href="/archives/">Archives</a></li>
        
      </ul>

      <!--
      <ul class="nav navbar-nav navbar-right">
        
          <li><a href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
      -->
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>

  <div class="container">
    <div class="blog-header">
  <h1 class="blog-title">Dave&#39;s Notebook</h1>
  
</div>

    <div class="row">
        <div class="col-sm-8 blog-main">
          <article id="post-test-driven-development-kata-roman-to-arabic-in-javascript" class="article article-type-post" itemscope itemprop="blogPost">

  <header class="article-header">
    
  
    <h1 class="article-title" itemprop="name">
      Test Driven Development Kata - Roman to Arabic in JavaScript
    </h1>
  


  </header>

  <div class="article-meta">
    <div class="article-datetime">
  <a href="/test-driven-development-kata-roman-to-arabic-in-javascript/" class="article-date"><time datetime="2016-07-20T10:30:00.000Z" itemprop="datePublished">2016-07-20</time></a>
</div>

    
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/TDD/">TDD</a>
  </div>


  </div>
  <div class="article-inner">

    <div class="article-entry" itemprop="articleBody">
      
        <p>Coding Katas are a way of developing your skills as a programmer.  I thought it might be informative to tackle one of the classics as a blog post. Depending on how this works, I may or may not do another one quite so publicly. The rules I’m going to try to adhere by.</p>
<ol>
<li>I will document what I am doing as I go.</li>
<li>This is not a pre-coded blog post.  You’ll get to “see” me code as I go.</li>
<li>I will write all tests first.</li>
<li>I will only write enough code to make the current tests succeed.</li>
</ol>
<p>  <img src="/uploads/2016/07/image-3.png" alt="Test Driven Kata - Roman to Arabic" title="Test Driven Kata - Roman to Arabic"></p>
<h2 id="Today’s-problem"><a href="#Today’s-problem" class="headerlink" title="Today’s problem:"></a>Today’s problem:</h2><p>This is a pretty classic coding problem that shows up in interviews, home-work assignments, and code katas.</p>
<p>As an interview problem, I find it lacking because it typically does not represent the kind of work you will be doing other than proving that you can solve problems in your chosen language.  It is also a standard coding problem, meaning the person interviewing you is using the most obvious problem to see if you can code.  Much like asking “What is your greatest strength?” and “What is your greatest weakness?”  Finally, it takes longer to complete than I believe interview coding problems should.  This is not to say, I don’t jump through these hoops myself.</p>
<p>As a kata exercise, it is good because there are several ways you might solve the problem.  And for our purposes, it also demonstrates what Test Driven Development might look like using JavaScript.</p>
<p>So, what is the problem? Write a function that converts Roman numbers into Arabic numbers and throws an error if the Roman number is in an invalid form.</p>
<p>That sounds pretty easy.  But the first question we need to ask is, “What, exactly are the rules for converting Roman numbers into Arabic numbers?”</p>
<ol>
<li>The values for Roman numbers are as follows:</li>
</ol>
<table>
<thead>
<tr>
<th align="center">Roman</th>
<th align="center">Arabic</th>
</tr>
</thead>
<tbody><tr>
<td align="center">I</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">V</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">X</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">L</td>
<td align="center">50</td>
</tr>
<tr>
<td align="center">C</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center">D</td>
<td align="center">500</td>
</tr>
<tr>
<td align="center">M</td>
<td align="center">1000</td>
</tr>
</tbody></table>
<ol start="2">
<li>Repeating a number up to three times adds that value three times.</li>
<li>A Roman ‘digit’ can’t repeat more than three times.  Instead the previous 1, 10, or 100 equivalent value is used to subtract from the next ‘digit’.  That is,</li>
</ol>
<table>
<thead>
<tr>
<th align="center">Roman</th>
<th align="center">Arabic</th>
</tr>
</thead>
<tbody><tr>
<td align="center">IV</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">IX</td>
<td align="center">9</td>
</tr>
<tr>
<td align="center">XL</td>
<td align="center">40</td>
</tr>
<tr>
<td align="center">XC</td>
<td align="center">90</td>
</tr>
<tr>
<td align="center">CD</td>
<td align="center">400</td>
</tr>
<tr>
<td align="center">CM</td>
<td align="center">900</td>
</tr>
</tbody></table>
<ol start="4">
<li>With the exception of the subtraction rule above, all values must decrease in scale from left to right and are added together.</li>
</ol>
<h2 id="Test-1"><a href="#Test-1" class="headerlink" title="Test 1"></a>Test 1</h2><p>Since we will be using JavaScript, the testing framework we will be using is Jasmine.</p>
<p>Our first test will simply test that when we pass in “I” we get back 1.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&quot;I&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the code that passes this test is:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You might think, what’s the point?  Why just return 1 when you know you are going to have to do more?  Well, when you are doing TDD, you have to work off of what you are testing for now, not what you might test for later.  So, we return 1.</p>
<h2 id="Test-2"><a href="#Test-2" class="headerlink" title="Test 2"></a>Test 2</h2><p>From here, we can go a couple of different directions.  How about testing for rule 3 next.  How would we do that? To start with, we might just make sure that if we pass in IV, we get back 4.  Now our code is getting a bit more complicated.  But sticking with our TDD principles, we’ll just test for IV.  Another happy path test.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&quot;I&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&quot;IV&quot;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the code that implements it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;IV&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Test-3"><a href="#Test-3" class="headerlink" title="Test 3"></a>Test 3</h2><p>OK.  What happens if IV shows up twice?  That should be a failure.  IV should never show up more than once.  In fact, none of the codes that show up in rule three should show up more than once.  Let’s make sure they don’t.</p>
<p>The tests for this will be pretty simple, and to save time, we will code for all of them at once.  In fact, we are going to eventually need the conversion tables above, so let’s go ahead and put them in now.</p>
<p>Here is what our test file looks like now.  Notice that we’ve put several tests in at once.</p>
<p>Notice that I didn’t have to write multiple tests to do this.  I just created one test and iterated over it.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the solution also iterates.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;IV&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Test-4"><a href="#Test-4" class="headerlink" title="Test 4"></a>Test 4</h2><p>Just to make sure we aren’t counting how many times in a row this all shows up, let’s add a valid Roman Number in between.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Test-5"><a href="#Test-5" class="headerlink" title="Test 5"></a>Test 5</h2><p>Next, we need to make sure that none of the items in our base table show up more than 3 times.  We’ll write a similar test to what we’ve already written with a twist.  If any of those numerals show up more than 4 times, we know we have a problem either because they are out of order or because they show up all in a row.  So, we only need to check the count.  If there are four of any of them, we have a problem.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the code to implement it.function romanToArabic(romanNumber){<br>    var minusOneTable &#x3D; {<br>        IV: 4,<br>        IX: 9,<br>        XL: 40,<br>        XC: 90,<br>        CD: 400,<br>        CM: 900<br>    };<br>    var baseTable &#x3D; {<br>        I: 1,<br>        V: 5,<br>        X: 10,<br>        L: 50,<br>        C: 100,<br>        D: 500,<br>        M: 1000<br>    };</p>
<pre><code>// This block is probably inefficient, but it is
// easy to reason about.
for(var prop in minusOneTable)&#123;
    if(!minusOneTable.hasOwnProperty(prop))&#123;
       continue;
    &#125;
    var rx = new RegExp(prop,&#39;g&#39;);
    if((romanNumber.match(rx) || []).length &gt; 1)&#123;
        throw &#39;Poorly formed Roman number!&#39;;
    &#125;

&#125;
for(var prop in baseTable)&#123;
    if(!baseTable.hasOwnProperty(prop))&#123;
        continue;
    &#125;
    var rx = new RegExp(prop,&#39;g&#39;);
    if((romanNumber.match(rx) || []).length &gt; 3)&#123;
        throw &#39;Poorly formed Roman number!&#39;;
    &#125;

&#125;

switch(romanNumber)&#123;
    case &#39;I&#39;:
        return 1;
    case &#39;IV&#39;:
        return 4;
&#125;
</code></pre>
<p>}</p>
<h2 id="Test-6"><a href="#Test-6" class="headerlink" title="Test 6"></a>Test 6</h2><p>So, before we move on to actually computing the value of the Roman number, we should ask ourselves if there are any other ways a Roman number could be passed in incorrectly.</p>
<p>The next one that occurs to me is this.  If you have a number that contains a ‘digit’ from the minusOneTable, the character that is used to subtract should never follow the digit.  For example, if “IV” shows up, there should not be an “I” immediately after it.  That is, we shouldn’t see “IVI” anywhere in our string.  So let’s add that to our tests.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the code to implement it:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;IV&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Step-7"><a href="#Step-7" class="headerlink" title="Step 7"></a>Step 7</h2><p>There is one more possible problem we could encounter.  What if someone passes in a character that isn’t a valid Roman number character.  We need to make sure that the only characters that show up are Roman number characters.</p>
<p>Since testing for all of the characters isn’t practical, we are just going to test for a few and assume that if this were a real business problem we’d go to the trouble of testing more.  But, the basic test is going to look the same.  Toss in bad characters in an otherwise valid string and make sure we throw an error.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the solution, which is pretty simple:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="comment">// make sure minusOne only shows up once</span></span><br><span class="line">    <span class="comment">// and first character isn&#x27;t also the last character. (IVI for example)</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> included = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// make sure digits only show up 3 times</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        included += prop;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class="line">    rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;[^&#x27;</span> + included + <span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">switch</span>(romanNumber)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;I&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;IV&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Step-8"><a href="#Step-8" class="headerlink" title="Step 8"></a>Step 8</h2><p>OK. I think that gets all of the validations except for ensuring that the numbers show up in numerical order.  To make this work, we are going to need to work through the array and assign each digit a value.  The test we need to write is going to put values in the wrong order.</p>
<p>Our test will put the next value up after the value.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>And the solution will put them in order and add them along the way.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">romanToArabic</span>(<span class="params">romanNumber</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> minusOneSub = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="string">&#x27;v&#x27;</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="string">&#x27;x&#x27;</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="string">&#x27;l&#x27;</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="string">&#x27;c&#x27;</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="string">&#x27;d&#x27;</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="string">&#x27;m&#x27;</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> compositeValueTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">v</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">x</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">l</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">c</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">d</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">m</span>: <span class="number">900</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// This block is probably inefficient, but it is</span></span><br><span class="line">    <span class="comment">// easy to reason about.</span></span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">var</span> rx;</span><br><span class="line">    <span class="comment">// make sure minusOne only shows up once</span></span><br><span class="line">    <span class="comment">// and first character isn&#x27;t also the last character. (IVI for example)</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">           <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>),<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> included = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="comment">// make sure digits only show up 3 times</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        included += prop;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">3</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// make sure only I, V, X, L, C and D are the only characters that show up</span></span><br><span class="line">    rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;[^&#x27;</span> + included + <span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>((romanNumber.<span class="title function_">match</span>(rx) || []).<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// substitute the minusOnes with tokens we can use to compute value.</span></span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        rx = <span class="keyword">new</span> <span class="title class_">RegExp</span>(prop,<span class="string">&#x27;g&#x27;</span>);</span><br><span class="line">        romanNumber = romanNumber.<span class="title function_">replace</span>(rx,minusOneSub[prop]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> romanNumberArray = romanNumber.<span class="title function_">split</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> returnValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> lastValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">var</span> currentValue = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> numberIndex = <span class="number">0</span>;numberIndex &lt; romanNumberArray.<span class="property">length</span>;numberIndex++)&#123;</span><br><span class="line">        currentValue = compositeValueTable[romanNumberArray[numberIndex]];</span><br><span class="line">        returnValue += currentValue;</span><br><span class="line">        <span class="keyword">if</span>(numberIndex &gt; <span class="number">0</span> &amp;&amp; currentValue &gt; lastValue)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="string">&#x27;Poorly formed Roman number&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        lastValue = currentValue;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> returnValue;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// switch(romanNumber)&#123;</span></span><br><span class="line">    <span class="comment">//     case &#x27;I&#x27;:</span></span><br><span class="line">    <span class="comment">//         return 1;</span></span><br><span class="line">    <span class="comment">//     case &#x27;IV&#x27;:</span></span><br><span class="line">    <span class="comment">//         return 4;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Step-9"><a href="#Step-9" class="headerlink" title="Step 9"></a>Step 9</h2><p>And finally we add some test to verify that we get the right result.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Review"><a href="#Review" class="headerlink" title="Review"></a>Review</h2><p>What?! I thought we were done? Well, we are and we aren’t.  We have code that works.  But is it the best code we can write? Here is what I like about this code:</p>
<ol>
<li>It is easy to reason about.</li>
<li>It allows me to add additional roman numbers by expanding my tables.  No additional code would be needed. (And while it is hard to represent using Arabic letters, there are additional symbols.)</li>
<li>It works reasonably fast.</li>
</ol>
<p>But, it does seem to me that we might make it a bit more efficient without sacrificing these advantages too much.  And the great news is, since we have our test in place, we can refactor with impunity.  No worries about breaking something because we will know as soon as we have and we can revert back to the code that was working.</p>
<h2 id="Step-12"><a href="#Step-12" class="headerlink" title="Step 12"></a>Step 12</h2><p>One pretty simple change we can make is that our error message is scattered throughout our code.  Let’s make that a variable and just throw the variable.</p>
<p>The other thing I wonder about is how much of our validations can be combined? One check we might safely eliminate at this point is the check to make sure the minus values only show up once.  If any of them were to show up more than once, they would either show up one after the other, which we still can check for, or they would be in the wrong value order which our final check will catch.  So, let’s eliminate that code as well and re-run our tests to make sure nothing broke.</p>
<p>And now that we’ve eliminated that check, we can create one big string for checking conditions like “IVI” into one string and check it once instead of creating a new RegExp object multiple times.</p>
<p>Here is the code we have so far:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Step-11"><a href="#Step-11" class="headerlink" title="Step 11"></a>Step 11</h2><p>Now that we have our IVI check down to one string, it occurs to me that we can combine this check with our invalid character check.  So, let’s do that next.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Step-12-1"><a href="#Step-12-1" class="headerlink" title="Step 12"></a>Step 12</h2><p>And the last place we can optimize is our three digit check.  But instead of limiting it to valid Roman numbers, let’s just check for any sequence of characters that repeats 4 times or more.</p>
<p>And once we know that is working, we can combine it with our other Regular Expressions.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Step-13"><a href="#Step-13" class="headerlink" title="Step 13"></a>Step 13</h2><p>We’ve cleaned up about all of the logic we can without hard coding the values.  But I would like to combine the lookup tables next.  I don’t like having three tables.  Let’s see if we can pull those into one table.</p>
<p>The first step to doing this is combining the minusOneTable and baseTable into one table.  To differentiate in the code that is using those tables, we’ll just look at the length of the property.</p>
<p>In the process of doing this, we notice that it would also make sense to combine the substitution table.  And since the values we’ve assigned to the table aren’t even being used at this point, we’ll just use the substitutions instead of the values.</p>
<p>And if we make the value of each element in the baseTable an array, we could combine the values into that table as well.  But that would over complicate our lookup logic when we compute the value.  So, I think we’ll just leave that as it is.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Step-14"><a href="#Step-14" class="headerlink" title="Step 14"></a>Step 14</h2><p>Finally, I think we want to consolidate the loops into one loop.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;tests/roman-to-arabic/RomanToArabic.spec.js&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> returnValue;</span><br><span class="line">    <span class="keyword">var</span> minusOneTable = &#123;</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">CD</span>: <span class="number">400</span>,</span><br><span class="line">        <span class="attr">CM</span>: <span class="number">900</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> baseTable = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">D</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="attr">M</span>: <span class="number">1000</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When I is passed in&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 1&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">1</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="title function_">describe</span>(<span class="string">&#x27;When IV is passed in&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            returnValue = <span class="title function_">romanToArabic</span>(<span class="string">&#x27;IV&#x27;</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="title function_">it</span>(<span class="string">&#x27;should return 4&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(<span class="number">4</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">var</span> prop;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27;I&#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy + <span class="string">&#x27;I&#x27;</span> + propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> baseTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!baseTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + prop + prop + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy+propCopy+propCopy+propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> minusOneTable)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!minusOneTable.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> newProp = prop + prop.<span class="title function_">substr</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + newProp + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,newProp));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// just test for one each of upper case, lower case, number and lower case valid character</span></span><br><span class="line">    <span class="keyword">var</span> invalidCharacters = &#123;<span class="attr">A</span>:<span class="number">1</span>,<span class="attr">a</span>:<span class="number">1</span>,<span class="string">&#x27;2&#x27;</span>: <span class="number">1</span>, <span class="attr">i</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> invalidCharacters)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!invalidCharacters.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> badOrderPairs = &#123;<span class="attr">DM</span>: <span class="number">1</span>, <span class="attr">LC</span>: <span class="number">1</span>, <span class="attr">VX</span>: <span class="number">1</span>, <span class="attr">IXXL</span>: <span class="number">1</span>, <span class="attr">IXM</span>: <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> badOrderPairs)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!badOrderPairs.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should throw an exception&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;<span class="title function_">romanToArabic</span>(propCopy)&#125;).<span class="title function_">toThrow</span>();</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> romanNumbers = &#123;</span><br><span class="line">        <span class="attr">I</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">II</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">III</span>: <span class="number">3</span>,</span><br><span class="line">        <span class="attr">IV</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">V</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">VI</span>: <span class="number">6</span>,</span><br><span class="line">        <span class="attr">VII</span>: <span class="number">7</span>,</span><br><span class="line">        <span class="attr">VIII</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">IX</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">X</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">XI</span>: <span class="number">11</span>,</span><br><span class="line">        <span class="attr">XII</span>: <span class="number">12</span>,</span><br><span class="line">        <span class="attr">XIII</span>: <span class="number">13</span>,</span><br><span class="line">        <span class="attr">XIV</span>: <span class="number">14</span>,</span><br><span class="line">        <span class="attr">XV</span>: <span class="number">15</span>,</span><br><span class="line">        <span class="attr">XVI</span>: <span class="number">16</span>,</span><br><span class="line">        <span class="attr">XVII</span>: <span class="number">17</span>,</span><br><span class="line">        <span class="attr">XVIII</span>: <span class="number">18</span>,</span><br><span class="line">        <span class="attr">XIX</span>: <span class="number">19</span>,</span><br><span class="line">        <span class="attr">XX</span>: <span class="number">20</span>,</span><br><span class="line">        <span class="attr">XXI</span>: <span class="number">21</span>,</span><br><span class="line">        <span class="attr">XXII</span>: <span class="number">22</span>,</span><br><span class="line">        <span class="attr">XXIII</span>: <span class="number">23</span>,</span><br><span class="line">        <span class="attr">XXIV</span>: <span class="number">24</span>,</span><br><span class="line">        <span class="attr">XXV</span>: <span class="number">25</span>,</span><br><span class="line">        <span class="attr">XXVI</span>: <span class="number">26</span>,</span><br><span class="line">        <span class="attr">XXVII</span>: <span class="number">27</span>,</span><br><span class="line">        <span class="attr">XXVIII</span>: <span class="number">28</span>,</span><br><span class="line">        <span class="attr">XXIX</span>: <span class="number">29</span>,</span><br><span class="line">        <span class="attr">XXX</span>: <span class="number">30</span>,</span><br><span class="line">        <span class="attr">XL</span>: <span class="number">40</span>,</span><br><span class="line">        <span class="attr">XLIV</span>: <span class="number">44</span>,</span><br><span class="line">        <span class="attr">XLV</span>: <span class="number">45</span>,</span><br><span class="line">        <span class="attr">XLVI</span>: <span class="number">46</span>,</span><br><span class="line">        <span class="attr">L</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="attr">LIV</span>: <span class="number">54</span>,</span><br><span class="line">        <span class="attr">LV</span>: <span class="number">55</span>,</span><br><span class="line">        <span class="attr">LVI</span>: <span class="number">56</span>,</span><br><span class="line">        <span class="attr">LX</span>: <span class="number">60</span>,</span><br><span class="line">        <span class="attr">XC</span>: <span class="number">90</span>,</span><br><span class="line">        <span class="attr">C</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="attr">CI</span>: <span class="number">101</span>,</span><br><span class="line">        <span class="attr">CXI</span>: <span class="number">111</span>,</span><br><span class="line">        <span class="attr">CMXCIX</span>: <span class="number">999</span>,</span><br><span class="line">        <span class="attr">MDCLXVI</span>: <span class="number">1666</span></span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">for</span>(prop <span class="keyword">in</span> romanNumbers)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!romanNumbers.<span class="title function_">hasOwnProperty</span>(prop))&#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_">describe</span>(<span class="string">&#x27;When &#x27;</span> + prop + <span class="string">&#x27; is added&#x27;</span>,(<span class="keyword">function</span>(<span class="params">propCopy</span>)&#123;</span><br><span class="line">            <span class="title function_">beforeEach</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">                returnValue = <span class="title function_">romanToArabic</span>(propCopy);</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="title function_">it</span>(<span class="string">&#x27;should return &#x27;</span> + romanNumbers[propCopy] ,<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                <span class="title function_">expect</span>(returnValue).<span class="title function_">toBe</span>(romanNumbers[propCopy]);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;).<span class="title function_">bind</span>(<span class="variable language_">this</span>,prop));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Review-1"><a href="#Review-1" class="headerlink" title="Review"></a>Review</h2><p>There are probably a few other optimizations that could be made here.  But I’m afraid that each would sacrifice either the flexibility.  That is, we could hard code the regular expression validations, which would significantly reduce the number of lines of code.  Or we would sacrifice the readability.  Neither of which I am willing to do.</p>
<p>If you are only interested in the result, you can find the finished project at <a target="_blank" rel="noopener" href="//github.com/DaveMBush/JavaScriptKatas" title="https://github.com/DaveMBush/JavaScriptKatas">https://github.com/DaveMBush/JavaScriptKatas</a></p>

      
    </div>

    
      

    

    <footer class="article-footer">
      <a data-url="http://davembush.github.com/test-driven-development-kata-roman-to-arabic-in-javascript/" data-id="cl2fb9o8h00jnw8hig07o37fi" class="article-share-link">
        <i class="fa fa-share"></i> Share
      </a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kata/" rel="tag">kata</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tdd/" rel="tag">tdd</a></li></ul>


    </footer>
  </div>
  
    
<ul id="article-nav" class="nav nav-pills nav-justified">
  
  <li role="presentation">
    <a href="/7-reasons-to-evade-ext-js/" id="article-nav-older" class="article-nav-link-wrap">
      <i class="fa fa-chevron-left pull-left"></i>
      <span class="article-nav-link-title">7 Reasons To Evade Ext JS</span>
    </a>
  </li>
  
  
  <li role="presentation">
    <a href="/4-reasons-to-drop-mvvm/" id="article-nav-newer" class="article-nav-link-wrap">
      <span class="article-nav-link-title">4 Reasons To Drop MVVM</span>
      <i class="fa fa-chevron-right pull-right"></i>
    </a>
  </li>
  
</ul>


  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments</noscript>
    <script src="https://giscus.app/client.js"
        data-repo="DaveMBush/davembush.github.io"
        data-repo-id="MDEwOlJlcG9zaXRvcnkxMzkwNzY1NTc="
        data-category="Announcements"
        data-category-id="DIC_kwDOCEojzc4CRNna"
        data-mapping="title"
        data-strict="1"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="light"
        data-lang="en"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
  </div>
</section>



        </div>
        <div class="col-sm-3 col-sm-offset-1 blog-sidebar">
          
  
  <div class="sidebar-module">
    <h4>Recents</h4>
    <ul class="sidebar-module-list">
      
        <li>
          <a href="/ngrx-performance-improvement/">NgRX Performance Improvement</a>
        </li>
      
        <li>
          <a href="/smart-ngrx/">smart-ngrx</a>
        </li>
      
        <li>
          <a href="/optimizing-angular-for-speed/">Optimizing Angular For Speed</a>
        </li>
      
        <li>
          <a href="/what-i-learned-writing-smartngrx/">What I Learned Writing SmartNgRX</a>
        </li>
      
        <li>
          <a href="/navigating-work-relationships/">Navigating Work Relationships</a>
        </li>
      
    </ul>
  </div>


  
  <div class="sidebar-module">
    <h4>Archives</h4>
    <ul class="sidebar-module-list"><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2024/12/">December 2024</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2024/10/">October 2024</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2023/08/">August 2023</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2023/07/">July 2023</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2023/03/">March 2023</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2022/12/">December 2022</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2022/11/">November 2022</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2022/07/">July 2022</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2022/05/">May 2022</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2021/09/">September 2021</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2021/05/">May 2021</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/11/">November 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/10/">October 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/06/">June 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2020/01/">January 2020</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/10/">October 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/09/">September 2018</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/08/">August 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/07/">July 2018</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/03/">March 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/02/">February 2018</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2018/01/">January 2018</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/12/">December 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/11/">November 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/10/">October 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/09/">September 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/08/">August 2017</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/07/">July 2017</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/06/">June 2017</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/05/">May 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/04/">April 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/03/">March 2017</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/02/">February 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2017/01/">January 2017</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/12/">December 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/11/">November 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/10/">October 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/09/">September 2016</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/08/">August 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/07/">July 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/06/">June 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/05/">May 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/04/">April 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/03/">March 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/02/">February 2016</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2016/01/">January 2016</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/12/">December 2015</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/11/">November 2015</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/10/">October 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/09/">September 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/08/">August 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/07/">July 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/06/">June 2015</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/05/">May 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/04/">April 2015</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/03/">March 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/02/">February 2015</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2015/01/">January 2015</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/12/">December 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/11/">November 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/10/">October 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/09/">September 2014</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/08/">August 2014</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/07/">July 2014</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/06/">June 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/05/">May 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/04/">April 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/03/">March 2014</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/02/">February 2014</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2014/01/">January 2014</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/12/">December 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/11/">November 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/10/">October 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/09/">September 2013</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/08/">August 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/07/">July 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/06/">June 2013</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/05/">May 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2013/01/">January 2013</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/09/">September 2012</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2012/08/">August 2012</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/10/">October 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2010/03/">March 2010</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/12/">December 2009</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/10/">October 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/09/">September 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/08/">August 2009</a><span class="sidebar-module-list-count">3</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/07/">July 2009</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/06/">June 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/04/">April 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/03/">March 2009</a><span class="sidebar-module-list-count">4</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/02/">February 2009</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2009/01/">January 2009</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/12/">December 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/11/">November 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/08/">August 2008</a><span class="sidebar-module-list-count">2</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/07/">July 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/06/">June 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/05/">May 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2008/04/">April 2008</a><span class="sidebar-module-list-count">1</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/11/">November 2007</a><span class="sidebar-module-list-count">5</span></li><li class="sidebar-module-list-item"><a class="sidebar-module-list-link" href="/archives/2007/10/">October 2007</a><span class="sidebar-module-list-count">1</span></li></ul>
  </div>




        </div>
    </div>
  </div>
  <footer class="blog-footer">
  <div class="container">
    <div id="footer-info" class="inner">
      &copy; 2024 Dave M Bush<br>
      All opinions are my own and do not reflect any company I have or am currently working at.<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

  

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>




<script src="/js/script.js"></script>


</body>
</html>
