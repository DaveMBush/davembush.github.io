<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>http://davembush.github.com</id>
    <title>Dave&#39;s Notebook • Posts by &#34;mvp&#34; tag</title>
    <link href="http://davembush.github.com" />
    <updated>2021-05-08T15:55:53.000Z</updated>
    <category term="project management" />
    <category term="code coverage" />
    <category term="tdd" />
    <category term="unit test" />
    <category term="code" />
    <category term="programming" />
    <category term="angular" />
    <category term="javascript" />
    <category term="performance" />
    <category term="react.js" />
    <category term="agile" />
    <category term="failure" />
    <category term="kanban" />
    <category term="scrum" />
    <category term="interview" />
    <category term="job search" />
    <category term="test driven development" />
    <category term="mvvm" />
    <category term="DRY" />
    <category term="loose coupling" />
    <category term="single responsibility" />
    <category term="c#" />
    <category term="learning" />
    <category term="bug" />
    <category term="ext js" />
    <category term="sencha" />
    <category term="career" />
    <category term="react" />
    <category term="ngrx" />
    <category term="redux" />
    <category term="functional" />
    <category term="reactive" />
    <category term="mvp" />
    <category term="private" />
    <category term="testing" />
    <category term="typescript" />
    <category term="routing" />
    <category term="pointers" />
    <category term="unsafe" />
    <category term="class diagram" />
    <category term="vb.net" />
    <category term="visual studio" />
    <category term="flux" />
    <category term="lazy loading" />
    <category term="scope" />
    <category term="DOM" />
    <category term="ionic" />
    <category term="putty" />
    <category term="ssh" />
    <category term="formgroup" />
    <category term="validation" />
    <category term="angular-cli" />
    <category term="modules" />
    <category term="ngmodule" />
    <category term="observables" />
    <category term="RxJS" />
    <category term="model driven" />
    <category term="reactive forms" />
    <category term="estimating" />
    <category term="story points" />
    <category term="best practices" />
    <category term="design patterns" />
    <category term="architecture" />
    <category term="asp.net" />
    <category term="memory" />
    <category term="angular.js" />
    <category term="iis" />
    <category term="ajax" />
    <category term="json" />
    <category term="controller" />
    <category term="MVC" />
    <category term="view" />
    <category term="404" />
    <category term="application_error" />
    <category term="exceptions" />
    <category term="viewstate" />
    <category term="archietcture" />
    <category term="bll" />
    <category term="dal" />
    <category term="Three Tiered" />
    <category term=".net" />
    <category term="enums" />
    <category term="tutorial" />
    <category term="code quality" />
    <category term="cyclomatic" />
    <category term="halstead" />
    <category term="child component" />
    <category term="CefSharp" />
    <category term="Chromium" />
    <category term="Vista" />
    <category term="VPN" />
    <category term="xp" />
    <category term="get" />
    <category term="properties" />
    <category term="set" />
    <category term="empty" />
    <category term="string" />
    <category term="habits" />
    <category term="application testing" />
    <category term="dependency injection" />
    <category term="debugging" />
    <category term="cms" />
    <category term="dotnetnuke" />
    <category term="WordPress" />
    <category term="authority" />
    <category term="confidence" />
    <category term="datalist" />
    <category term="listview" />
    <category term="comments" />
    <category term="tdd. agile" />
    <category term="bootstrap" />
    <category term="copy &amp;amp; paste" />
    <category term="cross browser" />
    <category term="idisposable" />
    <category term="animation" />
    <category term="css" />
    <category term="html" />
    <category term="debug" />
    <category term="checked" />
    <category term="double" />
    <category term="float" />
    <category term="int" />
    <category term="long" />
    <category term="short" />
    <category term="unchecked" />
    <category term="currency" />
    <category term="decimal" />
    <category term="floating point math" />
    <category term="single" />
    <category term="authentication" />
    <category term="isinrole" />
    <category term="roles" />
    <category term="user" />
    <category term="definition of done" />
    <category term="DoD" />
    <category term="dispose" />
    <category term="finalize" />
    <category term="suppressfinalize" />
    <category term="education" />
    <category term="client side" />
    <category term="development" />
    <category term="class" />
    <category term="dynamic classing" />
    <category term="gridview" />
    <category term="college" />
    <category term="freshman" />
    <category term="babel" />
    <category term="es2015" />
    <category term="es6" />
    <category term="jest" />
    <category term="bdd" />
    <category term="Single Responsibility" />
    <category term="Architecture" />
    <category term="full stack developer" />
    <category term="web development" />
    <category term="formsauthentication" />
    <category term="manual" />
    <category term="redirectfromloginpage" />
    <category term="setauthcookie" />
    <category term="NgRX" />
    <category term="luck" />
    <category term="social skills" />
    <category term="brain" />
    <category term="health" />
    <category term="programmer" />
    <category term="productivity" />
    <category term="QA" />
    <category term="extreme programming" />
    <category term="software" />
    <category term="httpcontext" />
    <category term="items" />
    <category term="session" />
    <category term="naming conventions" />
    <category term="variables" />
    <category term="self improvement" />
    <category term="301" />
    <category term="302" />
    <category term="fiddler" />
    <category term="infinite loop" />
    <category term="images" />
    <category term="iTextSharp" />
    <category term="PDF" />
    <category term="concatenation" />
    <category term="quirks" />
    <category term="parsing" />
    <category term="xhtml" />
    <category term="fonts" />
    <category term="stack" />
    <category term="htmltidy" />
    <category term="tables" />
    <category term="acrofields" />
    <category term="form fields" />
    <category term="outputstream" />
    <category term="pdfreader" />
    <category term="pdfstamper" />
    <category term="bind" />
    <category term="callbacks" />
    <category term="currying" />
    <category term="events" />
    <category term="business rules" />
    <category term="boolean" />
    <category term="fields" />
    <category term="methods" />
    <category term="object" />
    <category term="functions" />
    <category term="inheritance" />
    <category term="prototype" />
    <category term="hoist" />
    <category term="falsy" />
    <category term="truthy" />
    <category term="istanbul" />
    <category term="jasmine" />
    <category term="hoisting" />
    <category term="types" />
    <category term="type conversion" />
    <category term="dialog" />
    <category term="jQuery" />
    <category term="validation controls" />
    <category term="async" />
    <category term="each" />
    <category term="collapse" />
    <category term="expand" />
    <category term="load" />
    <category term="partial content" />
    <category term="tooltip" />
    <category term="regions" />
    <category term="limiting beliefs" />
    <category term="angular material" />
    <category term="linkedin" />
    <category term="social media" />
    <category term="tips" />
    <category term="CI. Continuous Integration" />
    <category term="magic numbers" />
    <category term="magic strings" />
    <category term="flex" />
    <category term="multiview" />
    <category term="wizard" />
    <category term="threading" />
    <category term="intern" />
    <category term="express" />
    <category term="node" />
    <category term="nunit" />
    <category term="object initializers" />
    <category term="video" />
    <category term="reflection" />
    <category term="unity" />
    <category term="best practice" />
    <category term="asp.net postback button" />
    <category term="iText" />
    <category term="property based testing" />
    <category term="cli" />
    <category term="software architecture" />
    <category term="rxjs. angular 2" />
    <category term="redirect" />
    <category term="response" />
    <category term="responsive design" />
    <category term="parallel" />
    <category term="selenium" />
    <category term="Marble Testing" />
    <category term="java" />
    <category term="grid" />
    <category term="hub" />
    <category term="serialization" />
    <category term="specflow" />
    <category term="like" />
    <category term="sql" />
    <category term="tsql" />
    <category term="where clause" />
    <category term="do while" />
    <category term="for next" />
    <category term="ms-sql" />
    <category term="while" />
    <category term="gamification" />
    <category term="paired programming" />
    <category term="reference types" />
    <category term="stringbuilder" />
    <category term="value types" />
    <category term="technical debt" />
    <category term="activetabindex" />
    <category term="postback" />
    <category term="tab control" />
    <category term="tabcontrol" />
    <category term="kata" />
    <category term="extjs" />
    <category term="email" />
    <category term="mailaddress" />
    <category term="mailmessage" />
    <category term="smtpclient" />
    <category term="Quality" />
    <category term="behavior" />
    <category term="psychology" />
    <category term="portal" />
    <category term="web 1.0" />
    <category term="web 2.0" />
    <category term="trace" />
    <category term="compiler" />
    <category term="errror" />
    <category term="warning" />
    <category term="connection string" />
    <category term="dataset" />
    <category term="error" />
    <category term="web.config" />
    <category term="tslint" />
    <category term="emotions" />
    <category term="hiring" />
    <category term="aspnet_regsql" />
    <category term="forms based authentication" />
    <category term="jsdom" />
    <category term="karma" />
    <category term="noTDD" />
    <category term="bundling" />
    <category term="gulp" />
    <category term="minification" />
    <category term="node.js" />
    <category term="file upload" />
    <category term="objects" />
    <category term="hide" />
    <category term="vb.net attributes" />
    <category term="nothing" />
    <category term="nullable" />
    <category term="conditional startup" />
    <category term="windows forms" />
    <category term="winforms" />
    <category term="char" />
    <category term="split" />
    <category term="strict" />
    <category term="clarity" />
    <category term="ui" />
    <category term="ux" />
    <category term="asmx" />
    <category term="error handling" />
    <category term="webservice" />
    <category term="binary" />
    <category term="bitwise" />
    <category term="operators" />
    <category term="automation" />
    <category term="browser" />
    <category term="mstest" />
    <category term="immutable" />
    <category term="global" />
    <category term="await" />
    <category term="webapi" />
    <category term="configuration" />
    <category term="devops" />
    <category term="testcasedata" />
    <category term="testcasesource" />
    <category term="closure" />
    <category term="loops" />
    <category term="certification" />
    <category term="mcsd" />
    <category term="microsoft" />
    <category term="inversion of control" />
    <category term="ioc" />
    <category term="casting" />
    <category term="convert" />
    <category term="arguements" />
    <category term="command line" />
    <category term="main" />
    <category term="yagni" />
    <category term="npm" />
    <category term="nvm" />
    <category term="resumes" />
    <category term="change-detection" />
    <category term="state-management" />
    <category term="web-workers" />
    <category term="libraries" />
    <category term="strong typing" />
    <category term="linting" />
    <category term="constructors" />
    <category term="clean code" />
    <category term="smart-ngrx" />
    <category term="ngrx-store" />
    <category term="ngrx-entity" />
    <category term="ngrx-effects" />
    <category term="TypeScript" />
    <category term="Performance" />
    <entry>
        <id>http://davembush.github.com/how-to-avoid-binding-to-computed-values-in-angular/</id>
        <title>How to Avoid Binding to Computed Values in Angular</title>
        <link rel="alternate" href="http://davembush.github.com/how-to-avoid-binding-to-computed-values-in-angular/"/>
        <content type="html">&lt;p&gt;In my previous article about &lt;a href=&#34;../optimizing-angular-for-speed/&#34;&gt;Angular Performance&lt;/a&gt;, I indicated that one of the many ways you can produce an Angular application that performs well is by ensuring that you bind to a computed value.&lt;/p&gt;
&lt;p&gt;First, what did I mean by that?&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;p&gt;There two ways you might bind to a computed value.&lt;/p&gt;
&lt;p&gt;The most obvious way is by calling a method in the template’s corresponding class. But, properties count to. To be clear, a property is some code that uses a &lt;code&gt;get&lt;/code&gt; prefix.&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;somePropertyNameHere&lt;/span&gt;() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;something here&amp;#x27;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Now, you might think you need to avoid this when you use the square brackets to assign a variable to a component property, but this also goes for ngIf and ngFor code as well.&lt;/p&gt;
&lt;p&gt;What we are striving for is to not have the template recompute anything unless the data has actually changed.&lt;/p&gt;
&lt;p&gt;The only exception to this is the ngFor trackBy attribute which is used to ensure the whole list doesn’t re-render just because the array changed. I’m assuming you are using this.&lt;/p&gt;
&lt;p&gt;But, you say, I NEED to compute those values in order to display them correctly.&lt;/p&gt;
&lt;p&gt;OK, let’s assume for a second that this is true. The way you do this is with pipes.&lt;/p&gt;
&lt;h2 id=&#34;Pipes&#34;&gt;&lt;a href=&#34;#Pipes&#34; class=&#34;headerlink&#34; title=&#34;Pipes&#34;&gt;&lt;/a&gt;Pipes&lt;/h2&gt;&lt;p&gt;You should already be familiar with pipes because this is how we format dates, format numbers and subscribe to observables in the template.  But you aren’t limited to using the built-in pipes. You can create your own, and it is quite easy to do.&lt;/p&gt;
&lt;p&gt;All you need is a class with the &lt;code&gt;@pipe&lt;/code&gt; attribute that implements the &lt;code&gt;PipeTransform&lt;/code&gt; interface.&lt;/p&gt;
&lt;p&gt;The code you would normally place in the method of property of your component class can go in here instead.&lt;/p&gt;
&lt;p&gt;By doing this, Angular can see that the variable that is passed to it has changed, or not, and can determine when the code needs to be recomputed.&lt;/p&gt;
&lt;h2 id=&#34;ngOnChanges&#34;&gt;&lt;a href=&#34;#ngOnChanges&#34; class=&#34;headerlink&#34; title=&#34;ngOnChanges()&#34;&gt;&lt;/a&gt;ngOnChanges()&lt;/h2&gt;&lt;p&gt;Another way you might achieve the same goal is by trapping the &lt;code&gt;ngOnChanges()&lt;/code&gt; event for the component.&lt;/p&gt;
&lt;p&gt;Many times, any value that we would compute in a method or property to be pulled from the template is only going to change if an &lt;code&gt;@input&lt;/code&gt; value changed.&lt;/p&gt;
&lt;p&gt;Instead of pulling the value and computing it on every change detection cycle, you can listen for the dependency during the &lt;code&gt;ngOnChanges&lt;/code&gt; event and assign the new value to a class field and have your template look at the field instead.&lt;/p&gt;
&lt;p&gt;Be careful though. If you are lazy and recompute the field every time &lt;code&gt;ngOnChanges()&lt;/code&gt; is called, you really haven’t gained anything by it.  &lt;code&gt;ngOnChanges()&lt;/code&gt; will pass into you exactly what changed and you can use that to determine if the value should be recomputed.&lt;/p&gt;
&lt;h2 id=&#34;NgRX-Store-Selector&#34;&gt;&lt;a href=&#34;#NgRX-Store-Selector&#34; class=&#34;headerlink&#34; title=&#34;NgRX Store Selector&#34;&gt;&lt;/a&gt;NgRX Store Selector&lt;/h2&gt;&lt;p&gt;My favorite means of achieving the goal of not calling computed values is by using NgRX Store Selectors.&lt;/p&gt;
&lt;p&gt;When you are new to NgRX you may only be using the simple selector.&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; observerThing = &lt;span class=&#34;variable language_&#34;&gt;this&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;store&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;pipe&lt;/span&gt;(&lt;span class=&#34;title function_&#34;&gt;select&lt;/span&gt;(&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;params&#34;&gt;x&lt;/span&gt; =&amp;gt;&lt;/span&gt; x.&lt;span class=&#34;property&#34;&gt;storeSlice&lt;/span&gt;));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;And of course you can drill down from storeSlice into children if you need to.&lt;/p&gt;
&lt;p&gt;If you’ve graduated to Feature Selectors, your code may have graduated to:&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; observerThing = &lt;span class=&#34;variable language_&#34;&gt;this&lt;/span&gt;.&lt;span class=&#34;property&#34;&gt;store&lt;/span&gt;.&lt;span class=&#34;title function_&#34;&gt;pipe&lt;/span&gt;(&lt;span class=&#34;title function_&#34;&gt;select&lt;/span&gt;(featureSelector));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;where &lt;code&gt;featureSelector&lt;/code&gt; looks something like this:&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title function_&#34;&gt;createFeatureSelector&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;feature&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;params&#34;&gt;x&lt;/span&gt; =&amp;gt;&lt;/span&gt; x.&lt;span class=&#34;property&#34;&gt;featureSlice&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;but there are other uses for &lt;code&gt;createSelector&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;You can use it to combine slices:&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  slice1Selector,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  slice2Selector,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;(&lt;span class=&#34;params&#34;&gt;s1, s2&lt;/span&gt;) =&amp;gt;&lt;/span&gt; combineLogicGoesHere&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Or, you can use it to create a selector for a specific bit of information.&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  sliceSelector,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;params&#34;&gt;s1&lt;/span&gt; =&amp;gt;&lt;/span&gt; s1.&lt;span class=&#34;property&#34;&gt;s1Part&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;And by combining this, we can create a selector that does our formatting for us only when the underlying data has changed.&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; partSelector = &lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  sliceSelector,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;params&#34;&gt;s1&lt;/span&gt; =&amp;gt;&lt;/span&gt; s1.&lt;span class=&#34;property&#34;&gt;s1Part&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;let&lt;/span&gt; formatedPart = &lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  partSelector,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;params&#34;&gt;ps&lt;/span&gt; =&amp;gt;&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;formatPsHere&lt;/span&gt;(ps)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;And now, our template can listen to this the same as it would listen to any other selector.&lt;/p&gt;
&lt;p&gt;This is the method I most prefer. By pushing this code down into a selector, I don’t have to be concerned with explicitly detecting what has changed. I let the selector do that for me. I just respond to the change when it happens.&lt;/p&gt;
</content>
        <category term="angular" />
        <category term="ngrx" />
        <category term="functional" />
        <category term="reactive" />
        <category term="mvp" />
        <updated>2021-05-08T15:55:53.000Z</updated>
    </entry>
    <entry>
        <id>http://davembush.github.com/an-angular-application-architecture-that-works/</id>
        <title>An Angular Application Architecture That Works</title>
        <link rel="alternate" href="http://davembush.github.com/an-angular-application-architecture-that-works/"/>
        <content type="html">&lt;p&gt;The purpose of this article is to specify a working architecture that everyone can use for any Angular applications.  This architecture aims to achieve the following goals:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ensure that all parts of an application have a home so that anyone can pick up any application that uses this architecture and modify the application without having to learn where everything lives.&lt;/li&gt;
&lt;li&gt;Reduce the overall complexity of any one application by using well-established design patterns that work within the Angular ecosystem.&lt;/li&gt;
&lt;li&gt;Reduce the number of bugs introduced into an application by reducing the need for duplicate code.&lt;/li&gt;
&lt;/ul&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;Guiding-Principles&#34;&gt;&lt;a href=&#34;#Guiding-Principles&#34; class=&#34;headerlink&#34; title=&#34;Guiding Principles&#34;&gt;&lt;/a&gt;Guiding Principles&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Largely adhere to the &lt;a href=&#34;https://angular.io/guide/styleguide&#34;&gt;Angular Style Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Prefer Functional&amp;#x2F;Reactive programming over Imperative&amp;#x2F;Object Oriented programming.&lt;/li&gt;
&lt;li&gt;Prefer Composition over Inheritance when using Object Oriented programming&lt;/li&gt;
&lt;li&gt;For Object Oriented code, and where it applies, Functional&amp;#x2F;Reactive code, make your code S..D&lt;ul&gt;
&lt;li&gt;Adhere to the Single Responsibility Principle:&lt;ul&gt;
&lt;li&gt;Keep the size of the individual files (html, css, ts) small&lt;/li&gt;
&lt;li&gt;Separate file for each class, function, interface, enum, etc.&lt;/li&gt;
&lt;li&gt;Keep the cyclomatic complexity of functions and methods small.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Keep your code DRY&lt;/li&gt;
&lt;li&gt;Because we prefer Composition over Inheritance, the OLI part of SOLID don’t apply.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Prefer composition over child routes.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;Directory-Structure&#34;&gt;&lt;a href=&#34;#Directory-Structure&#34; class=&#34;headerlink&#34; title=&#34;Directory Structure&#34;&gt;&lt;/a&gt;Directory Structure&lt;/h2&gt;&lt;p&gt;Let’s start with the directory structure our applications will use.  To start with, the directory structure outlined in the &lt;a href=&#34;https://angular.io/guide/styleguide&#34;&gt;Angular Style Guide&lt;/a&gt; should be used with some minor modifications that still obey the general principles outlined in the style guide.&lt;/p&gt;
&lt;figure class=&#34;highlight text&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;projectFolder&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;+- src&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  +- core&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  +- dialogs&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- dialog1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      +- helper-component-1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      +- helper-component-2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      main dialog files go here directly&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      under the dialog directory&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - html, css, ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - dialog specific NgRX code&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- dialog2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      +- helperComponent3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      main dialog files go here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- etc...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  +- routes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- route-1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      +- supporting-component-1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      +- store&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        supporting route specific NgRX files go here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        these include actions, effects, services, reducers,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        and selectors.  Each set of files get their own&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        directory. The extensions for each are:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - *.actions.ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - *.effects.ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - *.service.ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - *.reducer.ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        - *.selector.ts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        route store slice module goes here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      route1 components go here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      route1 module goes here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- route-1-subroute-a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      similar to above.  This is only IF you have sub-routes.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      I strongly advise against them.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  +- shared&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- components&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      only components that are shared between routes go here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- store&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      only store files that are shared between routes go here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    +- services&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      only services, if any, that aren&amp;#x27;t used by your store go here&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;What is slightly different from the style guide is that a separate directory is created for dialogs and routes as these will be where my top-level components will live.  Within a route or a dialog, everything that route or dialog needs should live under it.  In the case where a class is needed by multiple routes or dialogs, these files live under shared.&lt;/p&gt;
&lt;p&gt;As a guiding principle, you should think of each route as a stand-alone application with its own module.  It should be able to run on its own using the classes, functions, etc from either its directory and sub-directories or the classes, functions, etc in the shared directory.&lt;/p&gt;
&lt;p&gt;This leads us to Lazy Loading&lt;/p&gt;
&lt;h2 id=&#34;Lazy-Loading&#34;&gt;&lt;a href=&#34;#Lazy-Loading&#34; class=&#34;headerlink&#34; title=&#34;Lazy Loading&#34;&gt;&lt;/a&gt;Lazy Loading&lt;/h2&gt;&lt;p&gt;While it is possible to create an application where the routes are all specified in one file, this file will quickly get out of hand if you are working with a large application.  You can save yourself a lot of trouble and reduce the cognitive load necessary to digest one file with all the routes if you commit to lazy loading up front.&lt;/p&gt;
&lt;h3 id=&#34;Routes&#34;&gt;&lt;a href=&#34;#Routes&#34; class=&#34;headerlink&#34; title=&#34;Routes&#34;&gt;&lt;/a&gt;Routes&lt;/h3&gt;&lt;p&gt;What this means from a practical perspective is that each route will be loaded in as it is needed. One of the side benefits of this is that the files necessary to run each route will only be loaded as they are needed. This will decrease the time it takes to load the application.&lt;/p&gt;
&lt;p&gt;You will, however, need to ensure that each route can be loaded directly because sometimes taking the expected path will load modules that you forgot to load as part of the route.&lt;/p&gt;
&lt;h3 id=&#34;NgRX&#34;&gt;&lt;a href=&#34;#NgRX&#34; class=&#34;headerlink&#34; title=&#34;NgRX&#34;&gt;&lt;/a&gt;NgRX&lt;/h3&gt;&lt;p&gt;Similarly, you should make use of feature stores in NgRX so that you can dynamically add in store slices with each module rather than loading them all in when the application loads.  Done correctly, this will also reduce the cognitive load around your store structure as you will only need to be concerned about the store structure for each route.&lt;/p&gt;
&lt;p&gt;For consistency’s sake, I create feature slices in my shared folder for NgRX slices that are shared rather than load them all at the application level. Again, this reduces the cognitive load necessary to understand any one part of the application. It has the added benefit of making it easier to move slices of the store from a route feature to a shared feature because the structure remains essentially the same.&lt;/p&gt;
&lt;h2 id=&#34;Components&#34;&gt;&lt;a href=&#34;#Components&#34; class=&#34;headerlink&#34; title=&#34;Components&#34;&gt;&lt;/a&gt;Components&lt;/h2&gt;&lt;p&gt;A large part of the front-end code is written using components which include the route, controls, and components that encompass blocks of components.&lt;/p&gt;
&lt;p&gt;The following addresses how to create components in a way that can be maintained.&lt;/p&gt;
&lt;h3 id=&#34;Keep-em-Small&#34;&gt;&lt;a href=&#34;#Keep-em-Small&#34; class=&#34;headerlink&#34; title=&#34;Keep em Small&#34;&gt;&lt;/a&gt;Keep em Small&lt;/h3&gt;&lt;p&gt;One of the main problems I’ve seen in my career with all code, but especially components, is that we try to put all the code for a page all in one place. We don’t even think of the third category of components.  My advice for your template code is that once it has gotten past the point of code that can’t fit in a file that is 150 lines long and 80 characters wide, or has nested to a point beyond 6 elements, you should consider breaking them out. There may be a few exceptions, but this metric will keep your code easy to understand.&lt;/p&gt;
&lt;p&gt;One way you can reduce the nesting without a lot of effort is to style the @host element of the template rather that using a containing DIV tag around the other elements that are the functional components of your component.  Other than because it reduces nesting, it also eliminates a layer of HTML that needs to be rendered. Since we are going to favor lots of small components over a few large components, this will, ultimately, impact the performance of your application.&lt;/p&gt;
&lt;p&gt;Another way you can reduce nesting is by recognizing patterns in your code and extracting them into their own component.&lt;/p&gt;
&lt;p&gt;Finally, consider measuring the cyclomatic complexity of your templates.  Codelyzer has a rule you can add to your linting.  I’d set this to no more than 10.  Cyclomatic complexity measures how many paths there are through your code.  Once you’ve added if, switch or for loops in your template, you’ve introduced some cyclomatic complexity. If you keep to the metrics I’ve already mentioned, you should never hit the cyclomatic complexity metric.&lt;/p&gt;
&lt;h3 id=&#34;Component-Services&#34;&gt;&lt;a href=&#34;#Component-Services&#34; class=&#34;headerlink&#34; title=&#34;Component Services&#34;&gt;&lt;/a&gt;Component Services&lt;/h3&gt;&lt;p&gt;Let’s talk about the purpose of components for a bit. The point of components is to allow the end user to interact with the program. In practical terms this means it has two jobs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Display data that is meaningful to the user&lt;/li&gt;
&lt;li&gt;Allow the user to issue commands that either manipulate the data or take them to another screen.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is true for whatever programming environment you are using.&lt;/p&gt;
&lt;p&gt;I’ve been programming now for 32 years and I still see programmers who try to make the component, or the view as they are sometimes called, do something else.&lt;/p&gt;
&lt;p&gt;This also means that business rules have no place in a component.&lt;/p&gt;
&lt;p&gt;Having said that, it is often true that to get the data to display we often need to introduce logic into our component somewhere. Once we’ve introduced logic, it would be great if we could also write unit tests for that logic without a lot of pain.&lt;/p&gt;
&lt;p&gt;If we put this code in the TS file that is our component, this means that in order to test the logic we need to scaffold the component.  Wouldn’t it be better or at least easier, if we didn’t need the component at all?&lt;/p&gt;
&lt;p&gt;This is where component services come in.  If you are familiar with the Model View Presenter design pattern, this is an adaptation of that.&lt;/p&gt;
&lt;p&gt;You can read details of how this is implemented on the following two sites:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://davembush.github.io/model-view-presenter-angular-and-testing/&#34;&gt;Model View Presenter, Angular, and Testing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://dev.to/this-is-angular/model-view-presenter-with-angular-533h&#34;&gt;Model View Presenter with Angular&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The basic idea is that you leave the component as the thing that only presents the data and receives notifications from the user. Any logic that is needed goes into an Angular service that is registered with the component using the viewProviders property of the @Component decorator.&lt;/p&gt;
&lt;p&gt;One thing to be careful of here is that you may be tempted, as I have been for a while, to pull the information from the service up into the view. The problem with this is that it is not an optimal implementation for change detections.&lt;/p&gt;
&lt;p&gt;The preferred method would be to use the model as it was originally intended and have the service set fields in the presentation layer so that change detection only happens when the data actually changes rather than every time the component is checked simply because your data has to be computed in a property or method every time.&lt;/p&gt;
&lt;p&gt;And while we are discussing change detection, you should also avoid changing the state of your component internally. By using OnPush notification, all changes have to come in on an &lt;code&gt;@Input()&lt;/code&gt; field for the component to know it has to do change detection. You can, of course, get around this by using &lt;code&gt;markForCheck()&lt;/code&gt; but the disadvantage there is that you may force change detection more often than it is actually needed.&lt;/p&gt;
&lt;p&gt;This is why we prefer the smart component&amp;#x2F;dumb component model. It forces many of these issues. To do this properly, you’ll probably need to create child components so you can take advantage of the &lt;code&gt;@Input()&lt;/code&gt; fields.&lt;/p&gt;
&lt;h3 id=&#34;Smart-x2F-Dumb&#34;&gt;&lt;a href=&#34;#Smart-x2F-Dumb&#34; class=&#34;headerlink&#34; title=&#34;Smart&amp;#x2F;Dumb&#34;&gt;&lt;/a&gt;Smart&amp;#x2F;Dumb&lt;/h3&gt;&lt;p&gt;Broadly speaking, Angular components can be classified as “Smart Components” or “Dumb Components”.  Smart Components get their data form the outside world and pass data out to the outside world.  In the architecture defined here, that will be from the NgRX store via selectors and into the NgRX store using Actions.&lt;/p&gt;
&lt;p&gt;Dumb Components render data they are passed via the @Input() decorators and fire events back up to the containing component via @Output() decorators.&lt;/p&gt;
&lt;p&gt;A lot of people understand these concepts but misunderstand how they apply to an Angular application. You can’t follow these rules simply by wrapping your Dumb Components in Smart Components. While this technically obeys the definition, the result is code that is hard to understand. What we want is a central location in our code that is always responsible for getting data to and from the store.&lt;/p&gt;
&lt;p&gt;We do this by specifying that our Routes are the Smart Components.  This includes child routes, if you have them.&lt;/p&gt;
&lt;p&gt;I’ve found that it is often easier to make a dialog a smart component as well, so if you find this is easier than passing the data that the dialog needs to the dialog, you can make dialogs smart as well. This is why we have a &lt;code&gt;dialogs&lt;/code&gt; directory and a &lt;code&gt;routes&lt;/code&gt; directory as immediate children of the &lt;code&gt;app&lt;/code&gt; directory.&lt;/p&gt;
&lt;h3 id=&#34;Forms&#34;&gt;&lt;a href=&#34;#Forms&#34; class=&#34;headerlink&#34; title=&#34;Forms&#34;&gt;&lt;/a&gt;Forms&lt;/h3&gt;&lt;p&gt;Technically, there are two ways of programming forms using Angular. The first way uses the old 2-way data-binding model and is called “Templated Forms.” These were popular in AngularJS (aka Angular 1).  The second is new to Angular (aka Angular 2+) and is called “Reactive Forms”. Our architecture will use the newer model because it conforms to the guiding principle of keeping things as Functional as possible and removing as much logic from the component as possible.&lt;/p&gt;
&lt;p&gt;There are several implications of how we program our forms related to this.&lt;/p&gt;
&lt;p&gt;First, you will define your FormGroup(s) in the Route’s component service.&lt;/p&gt;
&lt;p&gt;Second, in order to keep your templates small, you may be a need to put bits of your form in child components. You will find that each child component needs its own &lt;code&gt;formGroup&lt;/code&gt; attribute around the &lt;code&gt;formControls&lt;/code&gt; that it is responsible for.  The best way to do this is to pass the &lt;code&gt;formGroup&lt;/code&gt; down from the router into the child components and then assign that variable to the &lt;code&gt;formGroup&lt;/code&gt; attribute in the child component’s template.&lt;/p&gt;
&lt;p&gt;For particularly complex forms, I recommend creating a formGroup object as a separate file in each component’s directory and then use &lt;code&gt;Object.assign()&lt;/code&gt; to concatenate the parts into one whole.  This keeps the related code together while allowing you to assemble them into a form that Angular can use.&lt;/p&gt;
&lt;h3 id=&#34;onPush-Notification&#34;&gt;&lt;a href=&#34;#onPush-Notification&#34; class=&#34;headerlink&#34; title=&#34;onPush Notification&#34;&gt;&lt;/a&gt;onPush Notification&lt;/h3&gt;&lt;p&gt;One of the optimizations available to Angular is a method of change detection called “Push Notification”.  Simply stated, with Push Notification enabled, change detection for the component is only initiated if new data has been pushed into it via one of it’s @Input() variables. Otherwise it is skipped.&lt;/p&gt;
&lt;p&gt;In a large application, the performance gains using this mechanism are enormous. This is particularly true of an application that has an extremely nested or repetitive set of components. Each instance will be checked with each event that would cause the change detection cycle to kick off.&lt;/p&gt;
&lt;p&gt;Since we will be striving to keep our components small, our apps are even more susceptible to the problems associated with change detection.&lt;/p&gt;
&lt;p&gt;While it is true that Push Notification handles most of the situations, you will find that occasionally data in your component changes for some other reason. For this, you should use the ChangeDetectorRef methods.&lt;/p&gt;
&lt;h3 id=&#34;Styling&#34;&gt;&lt;a href=&#34;#Styling&#34; class=&#34;headerlink&#34; title=&#34;Styling&#34;&gt;&lt;/a&gt;Styling&lt;/h3&gt;&lt;p&gt;In an ideal world, you would have a theme that is external to all of your projects and that can be &lt;code&gt;npm install&lt;/code&gt;ed into all the projects you work on.  This should control the basic look and feel of your application including:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;font color, size, family etc&lt;/li&gt;
&lt;li&gt;background color&lt;/li&gt;
&lt;li&gt;default style for common components&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Lacking a separate project for your theming information, place this information in a global styles.css file.&lt;/p&gt;
&lt;p&gt;Under no circumstance would you ever place the above information directly in a component file within your application.&lt;/p&gt;
&lt;p&gt;Also, because all the main information is going to be in your theme, there is no benefit to using SCSS within your project. And, in fact, every project I’ve ever been a part of that tried to use SCSS as part of the project has become more of a mess and harder to maintain because of it.&lt;/p&gt;
&lt;p&gt;Use SCSS for your theme project and CSS for your application projects.&lt;/p&gt;
&lt;h2 id=&#34;NgRX-1&#34;&gt;&lt;a href=&#34;#NgRX-1&#34; class=&#34;headerlink&#34; title=&#34;NgRX&#34;&gt;&lt;/a&gt;NgRX&lt;/h2&gt;&lt;p&gt;We’ve already addressed some of how NgRX should be used when we talked about using Features instead of one great big Store blob.&lt;/p&gt;
&lt;p&gt;But, there are some other major places where NgRX gets misused that need to be addressed.&lt;/p&gt;
&lt;h3 id=&#34;One-to-One-vs-One-to-Many&#34;&gt;&lt;a href=&#34;#One-to-One-vs-One-to-Many&#34; class=&#34;headerlink&#34; title=&#34;One to One vs One to Many&#34;&gt;&lt;/a&gt;One to One vs One to Many&lt;/h3&gt;&lt;p&gt;If you are new to NgRX, one of the first things that will seem like a really good idea is that you should be able to create an action and have multiple Reducers or Effects respond to it. If you were to act on this impulse, you would (eventually) find that this ultimately makes your code hard to maintain because you are now calling multiple functions “at the same time.”&lt;/p&gt;
&lt;p&gt;From a maintenance perspective, this is a problem.  Imagine trying to track down the flow of execution in your application only to find that when you get to point X you now have to trace the action down multiple paths, not really knowing which ultimately is executing the code you are really interested in.&lt;/p&gt;
&lt;p&gt;But, you have a further hidden problem. The order those functions get called is, for all practical purposes, undefined. At least, from a programming perspective, they should be considered undefined. The order is probably deterministic for any particular version of NgRX that you are running, but when you upgrade there is no reason to believe the code will still execute in the same order.&lt;/p&gt;
&lt;p&gt;Similarly, your actions, reducers, and effects should only relate to each other. You shouldn’t have an action that is part of slice A being handled by slice B even if it is a one-to-one relationship.&lt;/p&gt;
&lt;p&gt;Some code I’ve seen has also aliased actions so that, technically action A is actually action B. Don’t do that! All the above make your code incredibly hard to track flow of control.&lt;/p&gt;
&lt;p&gt;If you were to do this, which I still don’t recommend, you should create actions that are clearly multi-use actions.&lt;/p&gt;
&lt;p&gt;So what if indeed a particular event needs to kick-off or update seperate slices of a store? The can be answered in a few ways.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;It may be worthwhile re-examining the architecture of your overall store. Is there a good rational for why a single Action will impact separate slices of a store in the first place? This is especially important if the resulting actions end up doing the same thing or are using the same data. If so, consider normalizing the store slices and removing redundancies.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If that passes the sniff test, consider dispatching different actions in sequence for that event. For example, you may be updating different parts of the application each with different information and structure or different service calls. Under this scenario, separate store slices will be updated via different store action sets and different information structures, regardless of whether they were initiated by the same event.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To reiterate, do not mix the various store slice actions just to intercept the same event.&lt;/p&gt;
&lt;h3 id=&#34;Flat-Store&#34;&gt;&lt;a href=&#34;#Flat-Store&#34; class=&#34;headerlink&#34; title=&#34;Flat Store&#34;&gt;&lt;/a&gt;Flat Store&lt;/h3&gt;&lt;p&gt;Another temptation you may encounter when you start working with NgRX is that you’ll return data from the server in a nested format and then try to deal with it in your reducer in that form.&lt;/p&gt;
&lt;p&gt;Don’t do that!&lt;/p&gt;
&lt;p&gt;Instead, flatten the data into multiple slices and use the Selectors to reassemble the data when you need it.&lt;/p&gt;
&lt;p&gt;If you are going to flatten the data on the client side, you should use &lt;a href=&#34;https://www.npmjs.com/package/normalizr&#34;&gt;Normalizr&lt;/a&gt;. Or, you could use &lt;a href=&#34;https://www.npmjs.com/package/normalizr&#34;&gt;NgRX-Normalizr&lt;/a&gt; and let it do some of the work for you.&lt;/p&gt;
&lt;p&gt;If you have the option, you should flatten your data on the server before you return it. The main advantage to doing this is that you will return less data.&lt;/p&gt;
&lt;p&gt;The reason you want to work with a flat store is because of immutability. Because the store is immutable, or at least, it SHOULD be, you will need to ensure that when you change an element of the data the object pointers above it all change as well. If you don’t, your change detection mechanisms won’t work correctly.&lt;/p&gt;
&lt;p&gt;If you use Normalizr and reassemble the nesting in your selectors, you won’t have to deal with this mess.&lt;/p&gt;
&lt;h3 id=&#34;Store-Everything&#34;&gt;&lt;a href=&#34;#Store-Everything&#34; class=&#34;headerlink&#34; title=&#34;Store Everything&#34;&gt;&lt;/a&gt;Store Everything&lt;/h3&gt;&lt;p&gt;You also may be tempted to only store some of your application state in the NgRX store.  Maybe you think storing search form data is overkill. That you’ll pass the data over as it is needed. That might work, for a while.&lt;/p&gt;
&lt;p&gt;But think about this. Once you’ve placed the data in the store, when you come back to a particular route, the data is still there. If you don’t, the data is gone and you have to fill in the form again.&lt;/p&gt;
&lt;p&gt;You might say, “But that’s what I want them to do.” Yes, but, what if the customer changes their mind? Now you have options.&lt;/p&gt;
&lt;p&gt;Another advantage to the “Store Everything” approach is that you’ve pushed the logic for handling the data changes further down the stack. One place this becomes noticeable is that when you decide to process the data, you no longer have to pass the data with the Action to process the data. The Effect that processes the Action can now retrieve the data from the store.&lt;/p&gt;
&lt;p&gt;If nothing else, this makes the code easier to test.  Code that is easier to test is code that is easier to maintain, even if you never write any test for the code.&lt;/p&gt;
&lt;h3 id=&#34;Data-Transformation&#34;&gt;&lt;a href=&#34;#Data-Transformation&#34; class=&#34;headerlink&#34; title=&#34;Data Transformation&#34;&gt;&lt;/a&gt;Data Transformation&lt;/h3&gt;&lt;p&gt;There are two places where data transformations might need to occur.  The first is after we retrieve the data or right before we send the data back. In an ideal world the server would always send back exactly what we need in the form we need it and we would send it back in a similar form. There are at least two advantages to this.  The first is that it will reduce the amount of processing that the client side code has to perform. Second, the data that that comes back will be generally smaller.&lt;/p&gt;
&lt;p&gt;The second place is as we are working with the data on the client side.&lt;/p&gt;
&lt;p&gt;One scenario where this would occur is when you update a field and the side effect is that data someplace else on the screen should change as well. Not because you retrieved data from somewhere but simply because you changed data in an input field.&lt;/p&gt;
&lt;p&gt;As I’ve already mentioned, we want to keep processing of data out of our components or even our component services unless the processing is specific to what the component does. The next logical place to put the processing of our store data is in our reducers.  But this has problems too. Maybe the data you want to display has no resemblance to the data that is in your store. Beyond that, this gets difficult to manage.&lt;/p&gt;
&lt;p&gt;Instead, the best place to handle data transformation is in your selector. Selectors have a function call as their last parameter that takes all the data slices from the previous parameters. This function can manipulate the data and return it in any way that makes sense for the application. It has the added advantage of being able to leverage memoization and changing the object pointer as I’ve already mentioned.&lt;/p&gt;
&lt;h3 id=&#34;Services&#34;&gt;&lt;a href=&#34;#Services&#34; class=&#34;headerlink&#34; title=&#34;Services&#34;&gt;&lt;/a&gt;Services&lt;/h3&gt;&lt;p&gt;A final temptation may be to ditch the Services that the Effects use and go after the REST end points directly. This seems to make sense since the Effects and the Services are both &lt;code&gt;@Injectable()&lt;/code&gt;s but the problem with this is primarily that it violates the Single Responsibility Principle.&lt;/p&gt;
&lt;p&gt;For retrieval of data, the Service is responsible for retrieving the data and possibly morphing it into the shape that we want it in. The Effect is primarily responsible for moving the resulting data into the store.&lt;/p&gt;
&lt;p&gt;The reverse is also true. Effects are responsible for collecting the data from wherever it is in the store and passing it to the Service.  The Service is responsible for sending that data to the server in the form that it needs it.&lt;/p&gt;
&lt;p&gt;One error I’ve seen is to inject the Store into the Service. The only &lt;code&gt;@Injectable()&lt;/code&gt; that should be injected into your HTTP Service is HttpClient.&lt;/p&gt;
&lt;h2 id=&#34;Angular-as-Functional-x2F-Reactive&#34;&gt;&lt;a href=&#34;#Angular-as-Functional-x2F-Reactive&#34; class=&#34;headerlink&#34; title=&#34;Angular as Functional&amp;#x2F;Reactive&#34;&gt;&lt;/a&gt;Angular as Functional&amp;#x2F;Reactive&lt;/h2&gt;&lt;p&gt;At the beginning of this article, I said one of the guiding principles of how we code is that we prefer Functional&amp;#x2F;Reactive programming over Imperative&amp;#x2F;Object Oriented programming.&lt;/p&gt;
&lt;p&gt;What does that mean?&lt;/p&gt;
&lt;p&gt;Imperative programming is code most of us are familiar with. It is code that says, do this, then do that, then do something else. Everything happens in sequence and it is very clear what happens when because the code says so.&lt;/p&gt;
&lt;p&gt;The problem with imperative programming is that it often contributes to tightly coupled code. In fact, this is the main reason Object Oriented code uses dependency injection and inversion of control.&lt;/p&gt;
&lt;p&gt;Object Oriented programming adds a layer on to imperative programming and tries to model everything in the world as a thing.  For example, a database Table, and User Interfaces are things. They lend themselves well to Object Oriented programming. By layering in dependency injection they decouple a lot of the code.&lt;/p&gt;
&lt;p&gt;But Object Oriented code still suffers from a problem. Not everything we are trying to write code for is a thing. Most of what we code is a process. Until recently, we’ve tried to shoehorn in a programming model that works for things and tried to make processes things somehow. It hasn’t worked well.&lt;/p&gt;
&lt;p&gt;Another problem with Imperative&amp;#x2F;Object Oriented programming is that it mutates memory and each function can return different values even though I’ve passed in the same values. This can make this model difficult to test.&lt;/p&gt;
&lt;p&gt;Think about it, which would you rather write a test for?  Code that given the same parameters always returns the same value, or code that is indeterminate.&lt;/p&gt;
&lt;p&gt;But wait, you say, all code is deterministic. Or is it?&lt;/p&gt;
&lt;p&gt;Take for example a method in a class that has two member variables.  The method itself takes a parameter and makes a call out to a database. How many possible return values are there for any given value we pass in?&lt;/p&gt;
&lt;p&gt;Well, here’s the problem, you actually have 4 parameters and one of these is difficult to control. Oh, sure, you could mock the call to the database and get some control. But if you could write code that didn’t require taming, wouldn’t that be helpful?&lt;/p&gt;
&lt;p&gt;Which leads us to Functional Programming. In Functional Programming we have a number of key advantages. First any given function passed the same parameters always returns the same value. Testing issues solved! Second, strictly functional code has no variables. As one article I read states, “You can’t screw up what you can’t change.” Third, everything is a function.&lt;/p&gt;
&lt;p&gt;This is an oversimplification, you can read more on functional programming elsewhere. One final advantage that most of the literature doesn’t mention is that Functional Programming models processes better than Object Oriented programming. And because of the features I mentioned above, it is also much easier to test and much more deterministic.&lt;/p&gt;
&lt;p&gt;Which leads to Reactive. Aside from the fact that we are using RxJS in Angular which is a Reactive library, this also means that we react to “events” that get fired.  This is essentially what is happening when you dispatch an action in NgRX, what you are effectively saying is, “someone do this thing for me.”&lt;/p&gt;
&lt;p&gt;In the past, you would have just coded for that process to start. Here, that action could just as easily happen on some other computer, or at least some other thread. And so, instead of coding “do this, then that, then this other thing.”  You are coding, “when I get notified, I’m going to do this and then, optionally, notify the system that I’m done.”&lt;/p&gt;
&lt;p&gt;And so, we favor Functional&amp;#x2F;Reactive programming because it makes our programs more stable but we admit that not everything can be done using a Functional&amp;#x2F;Reactive model.&lt;/p&gt;
&lt;h2 id=&#34;Data-over-Presentation&#34;&gt;&lt;a href=&#34;#Data-over-Presentation&#34; class=&#34;headerlink&#34; title=&#34;Data over Presentation&#34;&gt;&lt;/a&gt;Data over Presentation&lt;/h2&gt;&lt;p&gt;This is a specific instance of the previous point, but I want to call it out directly because I recognize that it is not quite as obvious to most people as it is to me.&lt;/p&gt;
&lt;p&gt;Most programmers, because they are still thinking in an imperative model, think of their code in terms of the presentation layer. What this means in terms of how they code is that when an event occurs in the view, they tend to fire an action. Sometimes this is the right thing to do. But, if the action that just occurred in the view also changed the state of your data in someway, it would make more sense to observe the data change in your store and react to it there than to fire off an event from the view to do the same thing.&lt;/p&gt;
&lt;p&gt;By following the rule of Data over Presentation, you benefit in two ways. The first is that more of your code will transfer to whatever JavaScript framework or library becomes popular in the future because RxJS is agnostic to which one you use.&lt;/p&gt;
&lt;p&gt;Second, by observing the data using &lt;code&gt;distinctUntilChanged()&lt;/code&gt; you can ensure that you only respond when the data actually changed instead of every time it looks like there may have been a change.&lt;/p&gt;
</content>
        <category term="angular" />
        <category term="ngrx" />
        <category term="functional" />
        <category term="reactive" />
        <category term="mvp" />
        <updated>2020-01-01T16:55:53.000Z</updated>
    </entry>
    <entry>
        <id>http://davembush.github.com/model-view-presenter-angular-and-testing/</id>
        <title>Model View Presenter, Angular, and Testing</title>
        <link rel="alternate" href="http://davembush.github.com/model-view-presenter-angular-and-testing/"/>
        <content type="html">&lt;p&gt;While testing Components is possible, it is not easy and is often pointless.  Using the Model View Presenter pattern, or a variation of it, solves the problem. &lt;/p&gt;
&lt;p&gt;Here’s the deal. Long time readers of my blog know I’ve been a proponent of Unit Testing for a very long time. While I was learning React, I went through the exercise of trying to write test as I was learning.  Now, the great thing about Angular and React is that it is possible to test your components.  The problem with testing components is that you are either testing that your HTML ended up in the right spot, that Angular directives did what they should, or you are evaluating the DOM to verify that component logic worked.  In most cases, putting tests that do any of these at the component level is the wrong way to test. &lt;figure&gt;&lt;img src=&#34;/uploads/2017/08/2017-08-27.jpg&#34; title=&#34;Model View Presenter, Angular, and Testing&#34;&gt;&lt;figcaption&gt;Photo credit: &lt;a href=&#34;//www.flickr.com/photos/tamworthboroughcouncil/15657023428/&#34;&gt;Tamworth Borough Council&lt;/a&gt; via &lt;a href=&#34;//visualhunt.com/re/e21893&#34;&gt;Visualhunt.com&lt;/a&gt; &amp;#x2F; &lt;a href=&#34;//creativecommons.org/licenses/by/2.0/&#34;&gt; CC BY&lt;/a&gt;&lt;/figcaption&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt; 

&lt;h2 id=&#34;Evaluating-HTML&#34;&gt;&lt;a href=&#34;#Evaluating-HTML&#34; class=&#34;headerlink&#34; title=&#34;Evaluating HTML&#34;&gt;&lt;/a&gt;Evaluating HTML&lt;/h2&gt;&lt;p&gt;Ignoring for a second that setting up a component test is awkward, the question I want to address here is, “is that really an appropriate test?” &lt;/p&gt;
&lt;p&gt;If all your smart component does is pass data down to dumb component, all you really need to verify is that given a dumb component with an html fragment, and another one with another fragment, they will all end up sequentially after each other.  It is a pretty easy test to setup. &lt;/p&gt;
&lt;p&gt;But all you’ve ended up testing is that Angular does what it says it will. It won’t tell you what you can’t already see by running the code. &lt;/p&gt;
&lt;p&gt;Dumb components are even more obvious.  Let’s go for something obvious.  You have a ngFor that allows you to display a list of HTML.  You setup your component so that it has an array of three known items, you pass that into the component, do a change detection cycle, and verify that your HTML displays as expected. &lt;/p&gt;
&lt;p&gt;Great, you’ve verified that Angular works again.  You will have a hard time convincing me that you’ve really tested anything.&lt;/p&gt;
&lt;h2 id=&#34;Angular-Directives&#34;&gt;&lt;a href=&#34;#Angular-Directives&#34; class=&#34;headerlink&#34; title=&#34;Angular Directives&#34;&gt;&lt;/a&gt;Angular Directives&lt;/h2&gt;&lt;p&gt;In this case, you are going to try to verify that when you click on a component, or pass it some data, or… whatever, that Angular does what it should.  Maybe you do need to verify that when you click an element, something else happens.  But this is not the place. &lt;/p&gt;
&lt;p&gt;You might create an integration test, which would, by definition, take longer to run.  It would be better if you tested this using an end to end test.  But testing this as a unit test, doesn’t tell you much more than that Angular has said that it would. &lt;/p&gt;
&lt;p&gt;“But, I need to verify that the code in my event handler does what it should!”  You might complain.  Yes, you do, but you don’t need to fire a click event to do that, just call the event handler.&lt;/p&gt;
&lt;h2 id=&#34;Big-Fat-Hairy-Logic&#34;&gt;&lt;a href=&#34;#Big-Fat-Hairy-Logic&#34; class=&#34;headerlink&#34; title=&#34;Big Fat Hairy Logic&#34;&gt;&lt;/a&gt;Big Fat Hairy Logic&lt;/h2&gt;&lt;p&gt;And then there is that “big fat hairy logic” issue.  You’ve created some sort of component that has some rather complex logic.  OK, that happens.  A grid control is a perfect example.  But, maybe your logic is in the wrong place?&lt;/p&gt;
&lt;h2 id=&#34;A-Better-Solution&#34;&gt;&lt;a href=&#34;#A-Better-Solution&#34; class=&#34;headerlink&#34; title=&#34;A Better Solution&#34;&gt;&lt;/a&gt;A Better Solution&lt;/h2&gt;&lt;p&gt;There is a design pattern called “Model View Presenter” Like all of the MV* patterns it aims to separate out logic from the view so that we can test things easier.  It was popular with WebForms in ASP.NET when that was how you wrote ASP.NET web sites.  The way this worked was that you would create an Interface for your WebForm that represented all of the things you wanted to have access to from your logic code.  Your presenter.  All your component or page code did was respond to events on the page and expose data to the data driven forms.  In a lot of ways, Angular isn’t much different from WebForms.  Your TypeScript file is essentially a “code-behind” file and your template is similar to an ASPX page. &lt;/p&gt;
&lt;p&gt;The beauty of the MVP pattern is that when you do it right, your component has no logic at all.  It renders data and responds to events by calling down to the presenter.  In an Angular world, I doubt the Presenter would ever need to call up to the view.  This is prefect.  Now I can create a test for my component logic in a way very similar to how I would test any other Injectable.  Because Injectables are what we are going to use here.&lt;/p&gt;
&lt;h3 id=&#34;Injectable-Presenters&#34;&gt;&lt;a href=&#34;#Injectable-Presenters&#34; class=&#34;headerlink&#34; title=&#34;Injectable Presenters&#34;&gt;&lt;/a&gt;Injectable Presenters&lt;/h3&gt;&lt;p&gt;For the point of illustration, let’s assume that all components would follow this pattern.  Now a simple component would have four files instead of the normal three.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;*.component.ts&lt;/li&gt;
&lt;li&gt;*.component.html&lt;/li&gt;
&lt;li&gt;*.component.css&lt;/li&gt;
&lt;li&gt;*.component.presenter.ts&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;code&gt;*.component.presenter.ts&lt;/code&gt; file is our new Injectable.  Any properties in our component would pass on down to the presenter.  Any methods, which should be few to none, would pass on down to the presenter.  The presenter is where we do all the work.&lt;/p&gt;
&lt;h3 id=&#34;Make-the-Presenter-Available-to-the-Component&#34;&gt;&lt;a href=&#34;#Make-the-Presenter-Available-to-the-Component&#34; class=&#34;headerlink&#34; title=&#34;Make the Presenter Available to the Component&#34;&gt;&lt;/a&gt;Make the Presenter Available to the Component&lt;/h3&gt;&lt;p&gt;Now, if you’ve studied the Angular tutorials, you probably already know this, but my bet is most people programming the new Angular don’t.  You can make an Injectable available by providing it in a module, or by providing it in a component.  If you provide it in the module, it is globally available.  If you provide it in the component, it is only available to that component or its child components.  This is perfect for our use case here.  So, we provide it in our component and then inject it into our component’s constructor. &lt;/p&gt;
&lt;p&gt;Everything else we might have injected into our component can now be injected into our presenter.&lt;/p&gt;
&lt;h2 id=&#34;Look-Ma-No-DOM&#34;&gt;&lt;a href=&#34;#Look-Ma-No-DOM&#34; class=&#34;headerlink&#34; title=&#34;Look Ma, No DOM&#34;&gt;&lt;/a&gt;Look Ma, No DOM&lt;/h2&gt;&lt;p&gt;The side effect of this pattern is now, the complexity of the methods in our component should be 1.  This means they don’t really need to be tested.  And because they don’t need to be tested, we don’t really need a DOM available to run our tests.  This makes it MUCH easier to use jsDOM to run our unit test without having to wire in a bunch of polyfills just to make it all “work.”&lt;/p&gt;
</content>
        <category term="unit test" />
        <category term="angular" />
        <category term="mvp" />
        <updated>2017-08-29T10:30:33.000Z</updated>
    </entry>
    <entry>
        <id>http://davembush.github.com/software-architecture-without-test-driven-development-is-dangerous/</id>
        <title>Software Architecture without Test Driven Development is DANGEROUS!</title>
        <link rel="alternate" href="http://davembush.github.com/software-architecture-without-test-driven-development-is-dangerous/"/>
        <content type="html">&lt;p&gt;&lt;img src=&#34;/uploads/2015/01/TddImpactsSoftwareArchitecture.png&#34; alt=&#34;TDD Impacts Software Architecture&#34; title=&#34;TddImpactsSoftwareArchitecture&#34;&gt;&lt;/p&gt;
&lt;p&gt;I’ve had two incidents recently that have shown me how TDD impacts Software Architecture.  Both of these are with code I’m working on.&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;What-Software-Architecture-Might-Do&#34;&gt;&lt;a href=&#34;#What-Software-Architecture-Might-Do&#34; class=&#34;headerlink&#34; title=&#34;What Software Architecture Might Do&#34;&gt;&lt;/a&gt;What Software Architecture Might Do&lt;/h2&gt;&lt;p&gt;Software architecture might specify how it is put together at a very high level.  For example, software architecture might specify that we use a three tiered approach or an n-tiered approach.  This approach places our view code is at one level, our business rules are at another level, and our data access at yet a third level.&lt;/p&gt;
&lt;p&gt;Software architecture might specify that we use MVC where our business rules are in the model, and a controller communicates between the view and the model to get data between the two.&lt;/p&gt;
&lt;p&gt;It might specify MVVM. This would have the view model take the place of the controller and manage the state information for the view.&lt;/p&gt;
&lt;p&gt;Software architecture might also tell us we should use MVP, giving the presenter the role of the controller and managing state information for the view and communicating with the business rules.&lt;/p&gt;
&lt;p&gt;But none of these patterns tell us how to write maintainable code.  They only tell us about the general software architecture.  This is like having a sketch of a house without a wiring or plumbing plan.&lt;/p&gt;
&lt;h2 id=&#34;When-the-view-gets-in-the-way&#34;&gt;&lt;a href=&#34;#When-the-view-gets-in-the-way&#34; class=&#34;headerlink&#34; title=&#34;When the view gets in the way&#34;&gt;&lt;/a&gt;When the view gets in the way&lt;/h2&gt;&lt;p&gt;So, if you’ve been following this blog for a while, you may remember that I’m working with EXTjs.  Specifically, I’m working with EXTjs 4.2.  This has what Sencha calls an MVC architecture.  The problem is, what they refer to as the “Model” we would all recognize as a “Record” in a table, and their Controller is tightly coupled to their View.  That is, they call this MVC, but no one who understands what MVC is supposed to look like as a design pattern would recognize Sencha’s MVC as the real MVC design pattern.&lt;/p&gt;
&lt;p&gt;This makes the code incredibly hard to test.  The tendency is to write code that is highly dependent on the view.  The view is dependent on the DOM.  Rendering the view takes quite a bit of time.  So any test of your business rules end up taking an incredibly long time to test because they ultimately cause DOM manipulation to occur.&lt;/p&gt;
&lt;p&gt;It isn’t until you decide to borrow a bit of architecture from Angular that you realize that your business rules should be separate classes.  Angular has “Service Classes.” My Service classes are built specifically so they do not rely on anything else.&lt;/p&gt;
&lt;p&gt;By doing this, I was able to get two thirds of my code under test that run in about a second.  Prior to this, they took a half an hour.&lt;/p&gt;
&lt;p&gt;My next task was to get the view and my logic for enabling and disabling controls on the view more loosely coupled.  This was a bit more difficult because enabling and disabling controls is, naturally, a view thing.&lt;/p&gt;
&lt;p&gt;But again, taking a page from another framework, this time Knockout and Angular, I created a ViewModel.  My ViewModel holds the state of my view separate from the actual view.  When the state changes, it fires an event that actually changes the view, but this will allow me to test my enable&amp;#x2F;disable logic, along with other code in my system, without ever instantiating the view.  Under test, the events will fire and nothing will happen.&lt;/p&gt;
&lt;h2 id=&#34;Avoiding-Dependencies&#34;&gt;&lt;a href=&#34;#Avoiding-Dependencies&#34; class=&#34;headerlink&#34; title=&#34;Avoiding Dependencies&#34;&gt;&lt;/a&gt;Avoiding Dependencies&lt;/h2&gt;&lt;p&gt;Now the structure  of my code looks something like the following: View – ViewModel – EnableDisableController – EnableDisableService I could have put the EnableDisableService code in the EnableDisableController, and many people would, but what I’ve found is that if I do that, it would be nearly impossible to UNIT test my Enable&amp;#x2F;Disable logic.  Why?  Because I would be creating all of the objects I needed for the logic in the same class the logic is in.&lt;/p&gt;
&lt;p&gt;By breaking the logic code into it’s own class that takes the ViewModel as a construction parameter, I can create my own ViewModel that looks exactly like what I need it to look like so that I can test the logic with entirely known values.&lt;/p&gt;
&lt;p&gt;These are just two of the ways that code architecture is impacted by Test Driven Development.  I’m sure there are others.&lt;/p&gt;
</content>
        <category term="tdd" />
        <category term="mvvm" />
        <category term="mvp" />
        <category term="MVC" />
        <category term="dependency injection" />
        <category term="software architecture" />
        <updated>2015-01-29T12:00:00.000Z</updated>
    </entry>
</feed>
