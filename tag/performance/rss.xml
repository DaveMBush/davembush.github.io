<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Dave&#39;s Notebook • Posts by &#34;performance&#34; tag</title>
        <link>http://davembush.github.com</link>
        <description></description>
        <language>English</language>
        <pubDate>Thu, 23 Nov 2023 08:34:41 -0500</pubDate>
        <lastBuildDate>Thu, 23 Nov 2023 08:34:41 -0500</lastBuildDate>
        <category>project management</category>
        <category>code coverage</category>
        <category>tdd</category>
        <category>unit test</category>
        <category>code</category>
        <category>programming</category>
        <category>angular</category>
        <category>javascript</category>
        <category>performance</category>
        <category>react.js</category>
        <category>agile</category>
        <category>failure</category>
        <category>kanban</category>
        <category>scrum</category>
        <category>interview</category>
        <category>job search</category>
        <category>test driven development</category>
        <category>mvvm</category>
        <category>DRY</category>
        <category>loose coupling</category>
        <category>single responsibility</category>
        <category>c#</category>
        <category>learning</category>
        <category>bug</category>
        <category>ext js</category>
        <category>sencha</category>
        <category>career</category>
        <category>react</category>
        <category>ngrx</category>
        <category>redux</category>
        <category>functional</category>
        <category>reactive</category>
        <category>mvp</category>
        <category>private</category>
        <category>testing</category>
        <category>typescript</category>
        <category>routing</category>
        <category>pointers</category>
        <category>unsafe</category>
        <category>class diagram</category>
        <category>vb.net</category>
        <category>visual studio</category>
        <category>flux</category>
        <category>lazy loading</category>
        <category>scope</category>
        <category>DOM</category>
        <category>ionic</category>
        <category>putty</category>
        <category>ssh</category>
        <category>formgroup</category>
        <category>validation</category>
        <category>angular-cli</category>
        <category>modules</category>
        <category>ngmodule</category>
        <category>observables</category>
        <category>RxJS</category>
        <category>model driven</category>
        <category>reactive forms</category>
        <category>estimating</category>
        <category>story points</category>
        <category>best practices</category>
        <category>design patterns</category>
        <category>architecture</category>
        <category>asp.net</category>
        <category>memory</category>
        <category>angular.js</category>
        <category>iis</category>
        <category>ajax</category>
        <category>json</category>
        <category>controller</category>
        <category>MVC</category>
        <category>view</category>
        <category>404</category>
        <category>application_error</category>
        <category>exceptions</category>
        <category>viewstate</category>
        <category>archietcture</category>
        <category>bll</category>
        <category>dal</category>
        <category>Three Tiered</category>
        <category>.net</category>
        <category>enums</category>
        <category>tutorial</category>
        <category>code quality</category>
        <category>cyclomatic</category>
        <category>halstead</category>
        <category>child component</category>
        <category>CefSharp</category>
        <category>Chromium</category>
        <category>Vista</category>
        <category>VPN</category>
        <category>xp</category>
        <category>get</category>
        <category>properties</category>
        <category>set</category>
        <category>empty</category>
        <category>string</category>
        <category>habits</category>
        <category>application testing</category>
        <category>dependency injection</category>
        <category>debugging</category>
        <category>cms</category>
        <category>dotnetnuke</category>
        <category>WordPress</category>
        <category>authority</category>
        <category>confidence</category>
        <category>datalist</category>
        <category>listview</category>
        <category>comments</category>
        <category>tdd. agile</category>
        <category>bootstrap</category>
        <category>copy &amp;amp; paste</category>
        <category>cross browser</category>
        <category>idisposable</category>
        <category>animation</category>
        <category>css</category>
        <category>html</category>
        <category>debug</category>
        <category>checked</category>
        <category>double</category>
        <category>float</category>
        <category>int</category>
        <category>long</category>
        <category>short</category>
        <category>unchecked</category>
        <category>currency</category>
        <category>decimal</category>
        <category>floating point math</category>
        <category>single</category>
        <category>authentication</category>
        <category>isinrole</category>
        <category>roles</category>
        <category>user</category>
        <category>definition of done</category>
        <category>DoD</category>
        <category>dispose</category>
        <category>finalize</category>
        <category>suppressfinalize</category>
        <category>education</category>
        <category>client side</category>
        <category>development</category>
        <category>class</category>
        <category>dynamic classing</category>
        <category>gridview</category>
        <category>college</category>
        <category>freshman</category>
        <category>babel</category>
        <category>es2015</category>
        <category>es6</category>
        <category>jest</category>
        <category>bdd</category>
        <category>Single Responsibility</category>
        <category>Architecture</category>
        <category>full stack developer</category>
        <category>web development</category>
        <category>formsauthentication</category>
        <category>manual</category>
        <category>redirectfromloginpage</category>
        <category>setauthcookie</category>
        <category>NgRX</category>
        <category>luck</category>
        <category>social skills</category>
        <category>brain</category>
        <category>health</category>
        <category>programmer</category>
        <category>productivity</category>
        <category>QA</category>
        <category>extreme programming</category>
        <category>software</category>
        <category>httpcontext</category>
        <category>items</category>
        <category>session</category>
        <category>naming conventions</category>
        <category>variables</category>
        <category>self improvement</category>
        <category>301</category>
        <category>302</category>
        <category>fiddler</category>
        <category>infinite loop</category>
        <category>images</category>
        <category>iTextSharp</category>
        <category>PDF</category>
        <category>concatenation</category>
        <category>quirks</category>
        <category>parsing</category>
        <category>xhtml</category>
        <category>fonts</category>
        <category>stack</category>
        <category>htmltidy</category>
        <category>tables</category>
        <category>acrofields</category>
        <category>form fields</category>
        <category>outputstream</category>
        <category>pdfreader</category>
        <category>pdfstamper</category>
        <category>bind</category>
        <category>callbacks</category>
        <category>currying</category>
        <category>events</category>
        <category>business rules</category>
        <category>boolean</category>
        <category>fields</category>
        <category>methods</category>
        <category>object</category>
        <category>functions</category>
        <category>inheritance</category>
        <category>prototype</category>
        <category>hoist</category>
        <category>falsy</category>
        <category>truthy</category>
        <category>istanbul</category>
        <category>jasmine</category>
        <category>hoisting</category>
        <category>types</category>
        <category>type conversion</category>
        <category>dialog</category>
        <category>jQuery</category>
        <category>validation controls</category>
        <category>async</category>
        <category>each</category>
        <category>collapse</category>
        <category>expand</category>
        <category>load</category>
        <category>partial content</category>
        <category>tooltip</category>
        <category>regions</category>
        <category>limiting beliefs</category>
        <category>angular material</category>
        <category>linkedin</category>
        <category>social media</category>
        <category>tips</category>
        <category>CI. Continuous Integration</category>
        <category>magic numbers</category>
        <category>magic strings</category>
        <category>flex</category>
        <category>multiview</category>
        <category>wizard</category>
        <category>threading</category>
        <category>intern</category>
        <category>express</category>
        <category>node</category>
        <category>nunit</category>
        <category>object initializers</category>
        <category>video</category>
        <category>reflection</category>
        <category>unity</category>
        <category>best practice</category>
        <category>asp.net postback button</category>
        <category>iText</category>
        <category>property based testing</category>
        <category>cli</category>
        <category>software architecture</category>
        <category>rxjs. angular 2</category>
        <category>redirect</category>
        <category>response</category>
        <category>responsive design</category>
        <category>parallel</category>
        <category>selenium</category>
        <category>Marble Testing</category>
        <category>java</category>
        <category>grid</category>
        <category>hub</category>
        <category>serialization</category>
        <category>specflow</category>
        <category>like</category>
        <category>sql</category>
        <category>tsql</category>
        <category>where clause</category>
        <category>do while</category>
        <category>for next</category>
        <category>ms-sql</category>
        <category>while</category>
        <category>gamification</category>
        <category>paired programming</category>
        <category>reference types</category>
        <category>stringbuilder</category>
        <category>value types</category>
        <category>technical debt</category>
        <category>activetabindex</category>
        <category>postback</category>
        <category>tab control</category>
        <category>tabcontrol</category>
        <category>kata</category>
        <category>extjs</category>
        <category>email</category>
        <category>mailaddress</category>
        <category>mailmessage</category>
        <category>smtpclient</category>
        <category>Quality</category>
        <category>behavior</category>
        <category>psychology</category>
        <category>portal</category>
        <category>web 1.0</category>
        <category>web 2.0</category>
        <category>trace</category>
        <category>compiler</category>
        <category>errror</category>
        <category>warning</category>
        <category>connection string</category>
        <category>dataset</category>
        <category>error</category>
        <category>web.config</category>
        <category>tslint</category>
        <category>emotions</category>
        <category>hiring</category>
        <category>aspnet_regsql</category>
        <category>forms based authentication</category>
        <category>jsdom</category>
        <category>karma</category>
        <category>noTDD</category>
        <category>bundling</category>
        <category>gulp</category>
        <category>minification</category>
        <category>node.js</category>
        <category>file upload</category>
        <category>objects</category>
        <category>hide</category>
        <category>vb.net attributes</category>
        <category>nothing</category>
        <category>nullable</category>
        <category>conditional startup</category>
        <category>windows forms</category>
        <category>winforms</category>
        <category>char</category>
        <category>split</category>
        <category>strict</category>
        <category>clarity</category>
        <category>ui</category>
        <category>ux</category>
        <category>asmx</category>
        <category>error handling</category>
        <category>webservice</category>
        <category>binary</category>
        <category>bitwise</category>
        <category>operators</category>
        <category>automation</category>
        <category>browser</category>
        <category>mstest</category>
        <category>immutable</category>
        <category>global</category>
        <category>await</category>
        <category>webapi</category>
        <category>configuration</category>
        <category>devops</category>
        <category>testcasedata</category>
        <category>testcasesource</category>
        <category>closure</category>
        <category>loops</category>
        <category>certification</category>
        <category>mcsd</category>
        <category>microsoft</category>
        <category>inversion of control</category>
        <category>ioc</category>
        <category>casting</category>
        <category>convert</category>
        <category>arguements</category>
        <category>command line</category>
        <category>main</category>
        <category>yagni</category>
        <category>npm</category>
        <category>nvm</category>
        <category>resumes</category>
        <category>change-detection</category>
        <category>state-management</category>
        <category>web-workers</category>
        <category>libraries</category>
        <category>strong typing</category>
        <category>linting</category>
        <category>constructors</category>
        <category>clean code</category>
        <item>
            <guid isPermalink="true">http://davembush.github.com/optimizing-angular-for-speed/</guid>
            <title>Optimizing Angular For Speed</title>
            <link>http://davembush.github.com/optimizing-angular-for-speed/</link>
            <category>angular</category>
            <category>performance</category>
            <category>best practice</category>
            <pubDate>Thu, 23 Nov 2023 08:34:41 -0500</pubDate>
            <description><![CDATA[ &lt;p&gt;I was recently asked how I would optimize an Angular site for speed. Interestingly, I’ve never written about this explicitly even though I’ve done a lot of work related to this issue.&lt;/p&gt;
&lt;p&gt;For the purposes of this article, I’m going to assume you have already implemented most of the things that Angular gives you “for free.” For example, we won’t discuss “Tree Shaking” or “AOT.” Those are given.&lt;/p&gt;
&lt;p&gt;Here are my 30 or so tips on how to optimize an Angular application for speed.&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;h2 id=&#34;Change-Detection&#34;&gt;&lt;a href=&#34;#Change-Detection&#34; class=&#34;headerlink&#34; title=&#34;Change Detection&#34;&gt;&lt;/a&gt;Change Detection&lt;/h2&gt;&lt;h3 id=&#34;OnPush-Notification&#34;&gt;&lt;a href=&#34;#OnPush-Notification&#34; class=&#34;headerlink&#34; title=&#34;OnPush Notification&#34;&gt;&lt;/a&gt;OnPush Notification&lt;/h3&gt;&lt;p&gt;Much has been written about how Angular Change Detection works, so I’m not going to go into much detail about this other than reiterate the basics.&lt;/p&gt;
&lt;p&gt;Without OnPush notification, angular will check the component to see if anything changes whenever an event occurs. This means something as simple as a mouse move will cause change detection evaluation.&lt;/p&gt;
&lt;p&gt;With OnPush, change detection on a component will happen only if one of the component’s properties (field marked with @Input() attribute) has changed or if you’ve explicitly told Angular that a change has occurred.&lt;/p&gt;
&lt;p&gt;In my experience, this isn’t going to generate enough of a performance difference that you can measure in seconds. But it will make a difference overall and is generally a quick win. So, start here.&lt;/p&gt;
&lt;p&gt;One quick way to ensure all your future components use OnPush when using the CLI to generate components is to ensure you add the OnPush configuration to your Angular.json file.&lt;/p&gt;
&lt;p&gt;You can find a good article about this &lt;a href=&#34;https://indepth.dev/overriding-angular-schematics/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;Small-Components&#34;&gt;&lt;a href=&#34;#Small-Components&#34; class=&#34;headerlink&#34; title=&#34;Small Components&#34;&gt;&lt;/a&gt;Small Components&lt;/h3&gt;&lt;p&gt;OnPush notification is only going to be useful if your components are small. Remember that once change detection has determined the component is dirty and needs to be re-rendered, the WHOLE component will be re-calculated even though there is no Virtual DOM diffing in IVY.&lt;/p&gt;
&lt;h3 id=&#34;Run-Outside-Zones&#34;&gt;&lt;a href=&#34;#Run-Outside-Zones&#34; class=&#34;headerlink&#34; title=&#34;Run Outside Zones&#34;&gt;&lt;/a&gt;Run Outside Zones&lt;/h3&gt;&lt;p&gt;It helps to understand how change detection works in Angular to optimize Angular change detection. Part of that equation is that it hooks into the fired events. This is how, for example, Angular knows it should update your screen when a click event occurs or when data is returned from an HttpClient request.&lt;/p&gt;
&lt;p&gt;But sometimes, we may trigger that event in our code when we know that change detection is unnecessary.&lt;/p&gt;
&lt;p&gt;For example, I have code that runs every 20 seconds to see if we should automatically log the user out. To keep this from running the change detection logic, I run this outside of the Zones logic.&lt;/p&gt;
&lt;p&gt;The specific API you are looking for, is &lt;code&gt;Zones.runOutsideAngular()&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Another place to look out for is the time-based RxJS operators such as &lt;code&gt;debounceTime()&lt;/code&gt;, &lt;code&gt;throttleTime()&lt;/code&gt;, etc. These operators will trigger change detection every time they fire. If you are using them in your code, consider running them outside of the Zones logic or use unpatched versions of the operators.&lt;/p&gt;
&lt;h3 id=&#34;Turn-Off-Zones&#34;&gt;&lt;a href=&#34;#Turn-Off-Zones&#34; class=&#34;headerlink&#34; title=&#34;Turn Off Zones&#34;&gt;&lt;/a&gt;Turn Off Zones&lt;/h3&gt;&lt;p&gt;Change detection might get triggered in multiple ways. And, in fact, your app probably doesn’t need all of them.&lt;/p&gt;
&lt;p&gt;You can turn things off using &lt;code&gt;__Zone_ignore_on_properties&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;There is more information on this &lt;a href=&#34;https://github.com/angular/zone.js/blob/master/STANDARD-APIS.md&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;That being said, I’ve done some performance testing and it turns out that &lt;a href=&#34;../ngzones-performance-impact/&#34;&gt;Change Detection is not the first place to look if your screen is rendering slowly&lt;/a&gt;.&lt;/p&gt;
&lt;h3 id=&#34;Use-Pipes&#34;&gt;&lt;a href=&#34;#Use-Pipes&#34; class=&#34;headerlink&#34; title=&#34;Use Pipes&#34;&gt;&lt;/a&gt;Use Pipes&lt;/h3&gt;&lt;p&gt;This tip is only really valuable in the cases where the Functional programming’s pure functions is relevant.&lt;/p&gt;
&lt;p&gt;The idea behind pure functions, at least as it applies to pipes, is that a pure function will always return the same value when given the same parameters. So, for example, the function &lt;code&gt;Add(a, b)&lt;/code&gt; will always return 4 given the parameters 2 and 2.&lt;/p&gt;
&lt;p&gt;Why recompute the value when you give it the same parameters as the previous time you called it?&lt;/p&gt;
&lt;p&gt;Using memoization, you can further take advantage of this optimization on functions that take extra time. This is what Angular Pipes do for you under the hood. But by implementing it yourself, you can cache more than the last value. I’m talking about the practice of holding onto a computed value and using the parameters as a key to look up the return value. Thus avoiding the computation completely.&lt;/p&gt;
&lt;p&gt;Use this optimization tip intelligently, though. Sometimes, values might be “the same,” but the content is different. I’m thinking about times when you would mutate the contents of an object. Say an array you added a value to instead of creating a new array. The array object pointer is still the same, so your pure function will not recompute the return value because the pointer didn’t change.&lt;/p&gt;
&lt;p&gt;If OnPush isn’t giving you all the optimization that you are looking for, creating a pure Pipe is the next step along the same lines.&lt;/p&gt;
&lt;p&gt;However, this is one place where I’d spend the extra time to verify that my “optimization” isn’t making the performance worse.&lt;/p&gt;
&lt;h3 id=&#34;Use-NgRX-Selectors&#34;&gt;&lt;a href=&#34;#Use-NgRX-Selectors&#34; class=&#34;headerlink&#34; title=&#34;Use NgRX Selectors&#34;&gt;&lt;/a&gt;Use NgRX Selectors&lt;/h3&gt;&lt;p&gt;Many people aren’t aware that NgRX has a Selector mechanism allowing memoization. When you call the Selector,  if nothing it depends on has changed, you get back the same answer you got the previous time you executed the method without having to run all the code that gave you the answer the first time.&lt;/p&gt;
&lt;p&gt;It also looks a lot cleaner than the &lt;code&gt;() =&amp;gt; state.subState&lt;/code&gt; mechanism we started out with.&lt;/p&gt;
&lt;p&gt;Note that parameterized selectors can’t take advantage of this memoization unless you roll your own.&lt;/p&gt;
&lt;figure class=&#34;highlight typescript&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; selectMemoizedThing = &lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(...);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;// vs&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;selectCantBeMemoized&lt;/span&gt; = (&lt;span class=&#34;params&#34;&gt;param&lt;/span&gt;) =&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;title function_&#34;&gt;createSelector&lt;/span&gt;(... uses param &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; here...)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h3 id=&#34;Don’t-Bind-to-Computed-Values&#34;&gt;&lt;a href=&#34;#Don’t-Bind-to-Computed-Values&#34; class=&#34;headerlink&#34; title=&#34;Don’t Bind to Computed Values&#34;&gt;&lt;/a&gt;Don’t Bind to Computed Values&lt;/h3&gt;&lt;p&gt;If your value is computed, Angular can’t easily determine if it has changed unless it calculates it.&lt;/p&gt;
&lt;p&gt;There are three ways to solve this issue.&lt;/p&gt;
&lt;p&gt;The first and most popular is to use a pipe, as described above. But it is the least desirable because it still forces the change detector to do more work than necessary.&lt;/p&gt;
&lt;p&gt;The second way to achieve this goal is by assigning a member field the computed value during the component’s &lt;code&gt;ngOnChanges&lt;/code&gt; event. Do this when the computed value uses values all internal to the component.&lt;/p&gt;
&lt;p&gt;Third, you can perform ALL the calculations in a Selector so that the data you need is already available and is easy to detect by the time you are binding.&lt;/p&gt;
&lt;p&gt;Finally, if you can, do the computation on the server so it isn’t even an issue on the client.&lt;/p&gt;
&lt;p&gt;For more information on this topic see my article &lt;a href=&#34;../how-to-avoid-binding-to-computed-values-in-angular/&#34;&gt;How to Avoid Binding to Computed Values in Angular&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;NgRX-Features&#34;&gt;&lt;a href=&#34;#NgRX-Features&#34; class=&#34;headerlink&#34; title=&#34;NgRX Features&#34;&gt;&lt;/a&gt;NgRX Features&lt;/h3&gt;&lt;p&gt;And while we are on the subject of NgRX, instead of creating one monster state to rule them all in the AppModule, use the Features to only instantiate the store reducers, effects, etc., as you need them.&lt;/p&gt;
&lt;h3 id=&#34;Use-RxJS-distinct&#34;&gt;&lt;a href=&#34;#Use-RxJS-distinct&#34; class=&#34;headerlink&#34; title=&#34;Use RxJS distinct()&#34;&gt;&lt;/a&gt;Use RxJS distinct()&lt;/h3&gt;&lt;p&gt;Did you know that your component is probably re-rendering more times than needed? This is because &lt;code&gt;@Input()&lt;/code&gt; values will mark the component every time it thinks it might have received a new value. You can prevent this by using &lt;code&gt;distinctUntilChanged()&lt;/code&gt; on the Observable.&lt;/p&gt;
&lt;h3 id=&#34;Use-RxJX-replay&#34;&gt;&lt;a href=&#34;#Use-RxJX-replay&#34; class=&#34;headerlink&#34; title=&#34;Use RxJX replay()&#34;&gt;&lt;/a&gt;Use RxJX replay()&lt;/h3&gt;&lt;p&gt;Another trick you can use is to use &lt;code&gt;replay()&lt;/code&gt; on the Observable. There are various ways to configure this, but the advantage is that this is another way to prevent calculations you don’t need. If the value isn’t going to change as you render the content multiple times on the screen, you only need to compute once and allow &lt;code&gt;replay()&lt;/code&gt; to memoize the return.&lt;/p&gt;
&lt;p&gt;Be careful with this trick though, because using it incorrectly can cause memory leaks.&lt;/p&gt;
&lt;h3 id=&#34;Use-RxJS-asapScheduler&#34;&gt;&lt;a href=&#34;#Use-RxJS-asapScheduler&#34; class=&#34;headerlink&#34; title=&#34;Use RxJS asapScheduler&#34;&gt;&lt;/a&gt;Use RxJS asapScheduler&lt;/h3&gt;&lt;p&gt;There are times when you need to schedule a task to run as soon as possible but asynchronously.&lt;/p&gt;
&lt;p&gt;You might think the best way to do this is by using interval(0) or some other mechanism.&lt;/p&gt;
&lt;p&gt;Maybe you want to use debounceTime(0) or throttleTime(0) to prevent the task from running too often.&lt;/p&gt;
&lt;p&gt;Did you know that RxJS has another scheduler, called the asapScheduler that allows you to run things faster than the default scheduler?&lt;/p&gt;
&lt;p&gt;The default scheduler uses the “macro queue”. This is what setTimeout() uses. The asapScheduler uses the “micro queue” which is what Promise.resolve uses.&lt;/p&gt;
&lt;p&gt;The difference is that if you schedule something with setTimeout(), and then run something with Promise.resolve(), the Promise.resolve() will run first. Make those asynchronous calls seems a bit more synchronous.&lt;/p&gt;
&lt;h3 id=&#34;Upgrade-to-IVY&#34;&gt;&lt;a href=&#34;#Upgrade-to-IVY&#34; class=&#34;headerlink&#34; title=&#34;Upgrade to IVY&#34;&gt;&lt;/a&gt;Upgrade to IVY&lt;/h3&gt;&lt;p&gt;In general, I suggest that you always keep your Angular version up to date.&lt;/p&gt;
&lt;p&gt;While we are on the topic of upgrades, in an enterprise environment, I suggest never to fall more than 2 major versions behind and never use the current major version. I keep my team using the latest version of the major version before the current version. This keeps us relatively current but far enough behind that someone else has figured out all the quirks of the version we are using.&lt;/p&gt;
&lt;p&gt;At a minimum, ensure you use a version that uses the IVY rendering engine to take advantage of the performance gains it introduced.&lt;/p&gt;
&lt;h2 id=&#34;Be-smart-about-HTML-and-CSS&#34;&gt;&lt;a href=&#34;#Be-smart-about-HTML-and-CSS&#34; class=&#34;headerlink&#34; title=&#34;Be smart about HTML and CSS&#34;&gt;&lt;/a&gt;Be smart about HTML and CSS&lt;/h2&gt;&lt;h3 id=&#34;Style-the-Host-of-your-Components&#34;&gt;&lt;a href=&#34;#Style-the-Host-of-your-Components&#34; class=&#34;headerlink&#34; title=&#34;Style the Host of your Components&#34;&gt;&lt;/a&gt;Style the Host of your Components&lt;/h3&gt;&lt;p&gt;Another place you can eak out a bit of performance without a lot of work is by eliminating the wrapping DIV element from your components.&lt;/p&gt;
&lt;p&gt;Most Angular developers are unaware that when the HTML template is rendered, the tag you use to render the component is also rendered.  So if you have a component who’s tag is &amp;lt;foo&amp;gt; and inside that component you included a DIV element that wraps all your control’s content, what actually renders on the screen is&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;foo&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    html for component here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;foo&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Now, it is true that the &amp;lt;foo&amp;gt; will get ignored by the browser. But it still has to evaluate it and determine that it shouldn’t do anything with it and it is extra context that has to be packaged by webpack.&lt;/p&gt;
&lt;p&gt;By styling &amp;lt;foo&amp;gt; to look like a DIV element by using&lt;/p&gt;
&lt;figure class=&#34;highlight css&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;selector-pseudo&#34;&gt;:host&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attribute&#34;&gt;display&lt;/span&gt;: block;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;attribute&#34;&gt;width&lt;/span&gt;: &lt;span class=&#34;number&#34;&gt;100%&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  ... whatever other styling you&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  might have given your &lt;span class=&#34;selector-tag&#34;&gt;div&lt;/span&gt; tag here&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;,&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;we can eliminate the inner DIV from our component and gain a bit of performance without going to a lot of trouble. The amount of performance gain you will see will depends on how many child components are being displayed at any one time.&lt;/p&gt;
&lt;h3 id=&#34;Don’t-overuse-SASS-x2F-SCSS&#34;&gt;&lt;a href=&#34;#Don’t-overuse-SASS-x2F-SCSS&#34; class=&#34;headerlink&#34; title=&#34;Don’t overuse SASS&amp;#x2F;SCSS&#34;&gt;&lt;/a&gt;Don’t overuse SASS&amp;#x2F;SCSS&lt;/h3&gt;&lt;p&gt;My general advice is to use CSS for your application and SASS for your component library or theme. Although, even in your component library, most of what you need to do can be done easily with CSS.&lt;/p&gt;
&lt;p&gt;I admit. When LESS and SASS first came out, I saw all the advantages. Since then, I’ve been persuaded by three events.&lt;/p&gt;
&lt;p&gt;First, if you write your Angular components small enough and use view encapsulation, you shouldn’t need any of the features that SASS would provide.&lt;/p&gt;
&lt;p&gt;Second, I’ve seen SASS abused more often than I’ve seen it used well. One project I worked on had 200 character class names because one of the developers was using &amp;amp; to concatenate the class names. The template code was cluttered with these long class names, making it difficult to read. Please! Don’t do this to your future self!&lt;/p&gt;
&lt;p&gt;Third, CSS has grown up. CSS variables now do most of what we may have needed to use SASS for. And, if you can keep your font and color information strictly in a theme.css file, you should never need to access them from your application components.&lt;/p&gt;
&lt;p&gt;Simple CSS is performant CSS.&lt;/p&gt;
&lt;h3 id=&#34;ng-content-Bad-Practices&#34;&gt;&lt;a href=&#34;#ng-content-Bad-Practices&#34; class=&#34;headerlink&#34; title=&#34;ng-content Bad Practices&#34;&gt;&lt;/a&gt;ng-content Bad Practices&lt;/h3&gt;&lt;p&gt;I’ve only recently realized that some of you are doing some pretty strange things with &lt;code&gt;ng-content&lt;/code&gt;, and then you wonder why your application is slow.&lt;/p&gt;
&lt;p&gt;As a refresher, &amp;#96;ng-content&amp;#96;&amp;#96; is what you use when you want to use content projection to pass content into a component. For example, if you wanted to pass in a list of items to a component, you might do something like this:&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;my-component&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt; *&lt;span class=&#34;attr&#34;&gt;ngFor&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;let item of items&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&amp;#123;item&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;my-component&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Now, the first thing you should ask yourself here is, “Do I need to use content projection here?”&lt;/p&gt;
&lt;p&gt;We’ve found a significant performance penalty for using content projection. So, if you can avoid it, you should.&lt;/p&gt;
&lt;p&gt;Notice, I said avoid. Not eliminate. There are some valid reasons for using content projections. For example, low-level components often need to use content projection because they could be a container for displaying anything.&lt;/p&gt;
&lt;p&gt;But, if you are using content projection to display exactly the same content or choice of content every time, consider eliminating the content projection and just hard-coding the content into the component. This will make the code easier to understand, and it will make the content render faster.&lt;/p&gt;
&lt;p&gt;The other crazy implementation I’ve seen recently is using ngIf inside ng-content.&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;ng-content&lt;/span&gt; *&lt;span class=&#34;attr&#34;&gt;ngIf&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;foobar&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;ng-content&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;It may not be obvious, but you should evaluate your DOM when the page is rendered with foobar equal to false. What you’ll see may surprise you. Inside of ng-content will be all the elements that are projected into the ng-content DOM element, but they will all be hidden.&lt;/p&gt;
&lt;p&gt;So what? So, they will all have to be evaluated by the browser even though they aren’t visible. This is a waste of resources and time rendering.&lt;/p&gt;
&lt;h3 id=&#34;Data-Binding-Issues&#34;&gt;&lt;a href=&#34;#Data-Binding-Issues&#34; class=&#34;headerlink&#34; title=&#34;Data Binding Issues&#34;&gt;&lt;/a&gt;Data Binding Issues&lt;/h3&gt;&lt;h4 id=&#34;innerHTML&#34;&gt;&lt;a href=&#34;#innerHTML&#34; class=&#34;headerlink&#34; title=&#34;innerHTML&#34;&gt;&lt;/a&gt;innerHTML&lt;/h4&gt;&lt;p&gt;Did you know that binding data to &lt;code&gt;innerHTML&lt;/code&gt; is slower than binding to the interpolation markers within the element?&lt;/p&gt;
&lt;p&gt;Often, we use&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt; [&lt;span class=&#34;attr&#34;&gt;innerHTML&lt;/span&gt;]=&lt;span class=&#34;string&#34;&gt;&amp;quot;someValue&amp;quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;instead of&lt;/p&gt;
&lt;figure class=&#34;highlight html&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&amp;#123;someValue&amp;#125;&amp;#125;&lt;span class=&#34;tag&#34;&gt;&amp;lt;/&lt;span class=&#34;name&#34;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;to get around string sanitation issues (which is another problem) but then we get someone on our team who is just learning Angular and they do this by default.&lt;/p&gt;
&lt;p&gt;In both cases, however, you’ll find if you measure the performance that the interpolation markers are significantly faster than the innerHTML binding.&lt;/p&gt;
&lt;h4 id=&#34;Avoid-Binding-to-Functions&#34;&gt;&lt;a href=&#34;#Avoid-Binding-to-Functions&#34; class=&#34;headerlink&#34; title=&#34;Avoid Binding to Functions&#34;&gt;&lt;/a&gt;Avoid Binding to Functions&lt;/h4&gt;&lt;p&gt;We mentioned this above but, another place where you can eak out a bit of performance is by avoiding binding to functions. If you do, you can use a pipe to memoize the return value of the function. But, using a pipe is the lazy man’s way of optimizing against the function issue.&lt;/p&gt;
&lt;p&gt;Why? Because you are still have the overhead of calling a function every time change detection runs, you just aren’t doing the calculation every time. It is better than doing the calculation but it is worse than binding to a field where the change detector can see if anything changed before it does anything else.&lt;/p&gt;
&lt;p&gt;In the interviews we run, we have a section that covers this issue. Code is clearly calling a function inside the template.  We are happy with the “use a pipe” answer. But I’m even more impressed if someone says something like, “This should all be done on the server, or if it can’t be done on the server, it should be done when we retrieve the data from the server.”&lt;/p&gt;
&lt;p&gt;But this can’t always be done. So, if you are going to bind to a function, ask yourself, “how far down the stack can I move this functionality?”&lt;/p&gt;
&lt;p&gt;In order of possibilities, I’d suggest:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Do the calculation in the pipe if nothing else is possible&lt;/li&gt;
&lt;li&gt;Do the calculation in the component’s TS file when the @Input() value changes&lt;/li&gt;
&lt;li&gt;Do the calculation in a Selector that the component is looking at&lt;/li&gt;
&lt;li&gt;Do the calculation right after you retrieve the data from the server&lt;/li&gt;
&lt;li&gt;Do the calculation on the server&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;HostBinding&#34;&gt;&lt;a href=&#34;#HostBinding&#34; class=&#34;headerlink&#34; title=&#34;HostBinding()&#34;&gt;&lt;/a&gt;HostBinding()&lt;/h3&gt;&lt;p&gt;Related to binding to functions, keep in mind that @HostBinding is databinding.  If you @HostBinding is using a function, it has the same issues as binding to a function in the template.&lt;/p&gt;
&lt;h3 id=&#34;Dynamic-CSS-Classes&#34;&gt;&lt;a href=&#34;#Dynamic-CSS-Classes&#34; class=&#34;headerlink&#34; title=&#34;Dynamic CSS Classes&#34;&gt;&lt;/a&gt;Dynamic CSS Classes&lt;/h3&gt;&lt;p&gt;There are multiple ways of dynamically adding classes to an element. Each one of them, essentially do the same thing. But worse, they all do them individually. So, if you end up using all three methods in your code, you are going to make at least 3 calls to the DOM to add or remove the class.&lt;/p&gt;
&lt;p&gt;Currently, using &lt;code&gt;ngClass&lt;/code&gt; adds and removes each class in it individually. You’d think it would be optimized to add them more efficiently but currently (2023-11-11) they do not.&lt;/p&gt;
&lt;p&gt;I’m hoping this gets fixed by the next major version of Angular.&lt;/p&gt;
&lt;h3 id=&#34;SVG-references-vs-SVG-inlining&#34;&gt;&lt;a href=&#34;#SVG-references-vs-SVG-inlining&#34; class=&#34;headerlink&#34; title=&#34;SVG references vs SVG inlining&#34;&gt;&lt;/a&gt;SVG references vs SVG inlining&lt;/h3&gt;&lt;p&gt;Another similar, hidden performance issue is the use of SVG Inlining. When you inject an SVG image into the page using inlining, the browser must evaluate the DOM elements. If you inline the same SVG image multiple times, the browser has to evaluate the DOM elements multiple times.&lt;/p&gt;
&lt;p&gt;The cure is to inline the SVG images once, and then, when you need to display the image, you can reference it using the SVG reference mechanism. There are multiple ways you might do this. One is to load them up front using a sprite and inject the sprite into the DOM. Another would be to inject the SVG image into the DOM using JavaScript the first time it is used and then reference it from that point forward.&lt;/p&gt;
&lt;h3 id=&#34;Measure-your-CSS&#34;&gt;&lt;a href=&#34;#Measure-your-CSS&#34; class=&#34;headerlink&#34; title=&#34;Measure your CSS&#34;&gt;&lt;/a&gt;Measure your CSS&lt;/h3&gt;&lt;p&gt;The most overlooked area of performance I know of is measuring CSS. I can’t go into a lot of detail about this here because it would take far too much time to explain (and read about) but there are good articles on the internet that discuss measuring browser performance using flame charts and other mechanisms that are part of your browser’s developer tools.&lt;/p&gt;
&lt;h2 id=&#34;Compile-for-Production&#34;&gt;&lt;a href=&#34;#Compile-for-Production&#34; class=&#34;headerlink&#34; title=&#34;Compile for Production&#34;&gt;&lt;/a&gt;Compile for Production&lt;/h2&gt;&lt;p&gt;Another place where we shouldn’t have to mention that it is even an option is compiling for production. &lt;/p&gt;
&lt;p&gt;In one product I worked on, I discovered we were deploying code using the development environment instead of the production environment. I only discovered this because we were getting the change detection after change warning in production. That’s the most notable difference. But this check happens with every change detection cycle and further slows down the code.&lt;/p&gt;
&lt;h2 id=&#34;Cache-your-code-on-the-browser&#34;&gt;&lt;a href=&#34;#Cache-your-code-on-the-browser&#34; class=&#34;headerlink&#34; title=&#34;Cache your code on the browser&#34;&gt;&lt;/a&gt;Cache your code on the browser&lt;/h2&gt;&lt;p&gt;If you build your application with an option that attaches a hash code to the file name, you can cache your javascript code on the browser so that the next time that browser tries to access the code, it will load it from the cache.&lt;/p&gt;
&lt;p&gt;Do not cache your index.html file, as you need to make sure that file always gets downloaded.&lt;/p&gt;
&lt;p&gt;Specifically, the options you want to implement on your server for your static files are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;immutable&lt;/li&gt;
&lt;li&gt;max-age 365&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This will prevent the browser from even checking the server for new code.&lt;/p&gt;
&lt;h2 id=&#34;CDN&#34;&gt;&lt;a href=&#34;#CDN&#34; class=&#34;headerlink&#34; title=&#34;CDN&#34;&gt;&lt;/a&gt;CDN&lt;/h2&gt;&lt;p&gt;Similarly, putting your files closer to the people retrieving them will improve your performance around “time to first render.”&lt;/p&gt;
&lt;h2 id=&#34;Perception-Beats-Reality&#34;&gt;&lt;a href=&#34;#Perception-Beats-Reality&#34; class=&#34;headerlink&#34; title=&#34;Perception Beats Reality&#34;&gt;&lt;/a&gt;Perception Beats Reality&lt;/h2&gt;&lt;p&gt;One place that gets overlooked when discussing performance is the “time to first render.”&lt;/p&gt;
&lt;p&gt;We recently ran into a situation where the code took so long to load that the client didn’t even see the spinner we had put in place to indicate we were loading data.&lt;/p&gt;
&lt;p&gt;To fix this, we added spinner code directly into our html file. It takes slightly longer to load the index.html file but displays more quickly than if we waited for our javascript to load.&lt;/p&gt;
&lt;h2 id=&#34;TrackBy-X-in-ngFor&#34;&gt;&lt;a href=&#34;#TrackBy-X-in-ngFor&#34; class=&#34;headerlink&#34; title=&#34;TrackBy X in ngFor&#34;&gt;&lt;/a&gt;TrackBy X in ngFor&lt;/h2&gt;&lt;p&gt;Another way to eak out more performance is by implementing the &lt;code&gt;trackBy&lt;/code&gt; property in your &lt;code&gt;ngFor&lt;/code&gt; loops.&lt;/p&gt;
&lt;p&gt;This is particularly useful when displaying a list that updates multiple times from the server. Because it is a brand-new object, every refresh will update the whole list.&lt;/p&gt;
&lt;p&gt;By using trackBy, you can tell Angular only to update the elements in the list that have changed by whatever you specify in TrackBy.&lt;/p&gt;
&lt;h2 id=&#34;Lazy-Loading&#34;&gt;&lt;a href=&#34;#Lazy-Loading&#34; class=&#34;headerlink&#34; title=&#34;Lazy Loading&#34;&gt;&lt;/a&gt;Lazy Loading&lt;/h2&gt;&lt;h3 id=&#34;Lazy-Load-Routes&#34;&gt;&lt;a href=&#34;#Lazy-Load-Routes&#34; class=&#34;headerlink&#34; title=&#34;Lazy Load Routes&#34;&gt;&lt;/a&gt;Lazy Load Routes&lt;/h3&gt;&lt;p&gt;Most applications have multiple routes that they access. But even if yours doesn’t, you should set your code up to use Lazy Loading for three reasons.&lt;/p&gt;
&lt;p&gt;First, small apps grow up. Eventually, you will have multiple routes. If your app is so small that it doesn’t, implementing Lazy Loading of routes isn’t going to hurt anything.&lt;/p&gt;
&lt;p&gt;Second, implementing Lazy Loading will break your code down further into multiple files. Most of the code in those files will never change, so once they are loaded and cached as instructed above, the only code that will ever need to be downloaded is code in your route when it changes.&lt;/p&gt;
&lt;p&gt;Third, having more files to download could help in the initial load of your application, as the client now has more opportunities to download the files in parallel. Measure this! I’ve seen this overused to the point of causing worse performance!&lt;/p&gt;
&lt;h3 id=&#34;Pre-load-Lazy-Loaded-Routes&#34;&gt;&lt;a href=&#34;#Pre-load-Lazy-Loaded-Routes&#34; class=&#34;headerlink&#34; title=&#34;Pre-load Lazy Loaded Routes&#34;&gt;&lt;/a&gt;Pre-load Lazy Loaded Routes&lt;/h3&gt;&lt;p&gt;Once you’ve started your app, you should load all the other routes in the background so your customer doesn’t have to wait for the next page to render.&lt;/p&gt;
&lt;p&gt;This is even more important when your application is on a mobile device that doesn’t have an Internet connection at times.&lt;/p&gt;
&lt;p&gt;You can also be selective about which routes you pre-load.&lt;/p&gt;
&lt;h3 id=&#34;Lazy-Loading-Resources&#34;&gt;&lt;a href=&#34;#Lazy-Loading-Resources&#34; class=&#34;headerlink&#34; title=&#34;Lazy Loading Resources&#34;&gt;&lt;/a&gt;Lazy Loading Resources&lt;/h3&gt;&lt;p&gt;Angular does most of this for you. Especially as it concerns CSS, but if your application has a lot of images, you should consider lazy loading those images.&lt;/p&gt;
&lt;h3 id=&#34;Virtual-Scrolling&#34;&gt;&lt;a href=&#34;#Virtual-Scrolling&#34; class=&#34;headerlink&#34; title=&#34;Virtual Scrolling&#34;&gt;&lt;/a&gt;Virtual Scrolling&lt;/h3&gt;&lt;p&gt;There are multiple implementations of this. But the idea is only to render what the user can see as the user scrolls rather than rendering everything into the DOM and then letting the browser to the scrolling.&lt;/p&gt;
&lt;p&gt;I reduced the rendering time from 8 seconds to 1 second on one mega app I worked on by implementing this concept.&lt;/p&gt;
&lt;h2 id=&#34;Good-Architecture&#34;&gt;&lt;a href=&#34;#Good-Architecture&#34; class=&#34;headerlink&#34; title=&#34;Good Architecture&#34;&gt;&lt;/a&gt;Good Architecture&lt;/h2&gt;&lt;h3 id=&#34;General-Patterns-and-Practices&#34;&gt;&lt;a href=&#34;#General-Patterns-and-Practices&#34; class=&#34;headerlink&#34; title=&#34;General Patterns and Practices&#34;&gt;&lt;/a&gt;General Patterns and Practices&lt;/h3&gt;&lt;p&gt;I’ve worked on optimizing an application where one of the first things we did was to straighten out the basic architecture.&lt;br&gt;I often tell people, “If you had any idea how software gets created, you’d be amazed that anything works as well as it does.” This application was no different.&lt;/p&gt;
&lt;p&gt;Someone had wanted to implement a feature in the next version of NgRX, so they copied code from the next version into the version we were using.&lt;/p&gt;
&lt;p&gt;It sounds harmless. But the result was the NgRX change detection got thrown into a loop that took thousands of cycles to resolve instead of just one or two. This, in turn, slowed the rendering time down on the application to a point where just switching routes took multiple seconds. On the order of 5–10 seconds.&lt;/p&gt;
&lt;p&gt;Upgrading the application to the version we wanted to use solved the problem.&lt;/p&gt;
&lt;p&gt;Other similar issues with this code were solved simply by fixing how the code had been assembled.&lt;/p&gt;
&lt;h3 id=&#34;Avoid-Code-That-Changes-Angular&#34;&gt;&lt;a href=&#34;#Avoid-Code-That-Changes-Angular&#34; class=&#34;headerlink&#34; title=&#34;Avoid Code That Changes Angular&#34;&gt;&lt;/a&gt;Avoid Code That Changes Angular&lt;/h3&gt;&lt;p&gt;Similar to the issue above is code that adds directives or other functionality that changes how Angular fundamentally works.&lt;/p&gt;
&lt;p&gt;There are two major reasons for this. The first is that we always want to be able to enlist people to help us with our code. Most of the time, we are trying to hire good Angular developers. If our code no longer looks like Angular, why hire Angular developers?&lt;/p&gt;
&lt;p&gt;Second, if the code changes how Angular works, it is probably hooking into some Angular internal that could change in a subsequent version of Angular. This means that you will have to wait for the code’s author to update their code before you can upgrade your application.&lt;/p&gt;
&lt;p&gt;Third, you can’t be sure some little project that thought it would be cool to add some feature to Angular to get around some perceived issue has fully tested their code. You could introduce a bug into your application that you must track down.&lt;/p&gt;
&lt;p&gt;Finally, you have to ask yourself. Does this feature, or set of features, solve a problem that would still exist if I’d written my code correctly in the first place? The one package I have in mind as I write this has contributed more to the technical debt on my project than any other package or programmer we’ve had interact with our code.&lt;/p&gt;
&lt;p&gt;Be careful what code you allow into your application; it could cost you far more than it is worth in the long run.&lt;/p&gt;
&lt;h2 id=&#34;Data-Access&#34;&gt;&lt;a href=&#34;#Data-Access&#34; class=&#34;headerlink&#34; title=&#34;Data Access&#34;&gt;&lt;/a&gt;Data Access&lt;/h2&gt;&lt;p&gt;So far, we’ve talked about what to do once we’ve retrieved the data into our application, but many performance issues can be avoided simply by paying attention to how and when we load our data from the server.&lt;/p&gt;
&lt;h3 id=&#34;Only-Load-What-You-Need&#34;&gt;&lt;a href=&#34;#Only-Load-What-You-Need&#34; class=&#34;headerlink&#34; title=&#34;Only Load What You Need&#34;&gt;&lt;/a&gt;Only Load What You Need&lt;/h3&gt;&lt;p&gt;One guiding principle for data access is that you should only load the data you need from the server at the point you need it.&lt;/p&gt;
&lt;p&gt;An example of where you might see this performance issue is that we tend to do a massive join of data on the server and return everything we retrieved, even if we don’t need the data for the operation at hand.&lt;/p&gt;
&lt;p&gt;The less data you access, the faster your application will perform.&lt;/p&gt;
&lt;h3 id=&#34;Normalization-is-a-Curse&#34;&gt;&lt;a href=&#34;#Normalization-is-a-Curse&#34; class=&#34;headerlink&#34; title=&#34;Normalization is a Curse&#34;&gt;&lt;/a&gt;Normalization is a Curse&lt;/h3&gt;&lt;p&gt;One way to send less data back to the server is to send it back in raw form rather than nested and normalized.&lt;/p&gt;
&lt;p&gt;For this, I recommend a product called Normalizr. This takes the nested data and breaks it into multiple tables. The product was originally written for client-side code to make using Redux and NgRX easier. But there are now server-side implementations you can use that structure the data before sending it back so that you only send back one instance of the data you need rather than multiple instances because multiple parent rows use it.&lt;/p&gt;
&lt;p&gt;Better than using Normalizr, which is now a bit dated, you should consider only asking for un-normalized data from the server and dumping it into NgRX entities. You can use NgRX selectors to join the data together however needed. Now that everyone should at least be using HTTP2, the cost of simultaneously making multiple requests to the server is negligible.&lt;/p&gt;
&lt;h3 id=&#34;Pre-load-Lookup-Tables&#34;&gt;&lt;a href=&#34;#Pre-load-Lookup-Tables&#34; class=&#34;headerlink&#34; title=&#34;Pre-load Lookup Tables&#34;&gt;&lt;/a&gt;Pre-load Lookup Tables&lt;/h3&gt;&lt;p&gt;Along with this same idea. We often have nested data that is the result of some lookup table. By using Normalizr, you could load those tables up front and then only return the key to those tables and use Normalizr and NgRX Selectors to do the JOIN on the client side, further reducing the overall amount of data that you need to retrieve at any one time.&lt;/p&gt;
&lt;h3 id=&#34;Virtual-Arrays&#34;&gt;&lt;a href=&#34;#Virtual-Arrays&#34; class=&#34;headerlink&#34; title=&#34;Virtual Arrays&#34;&gt;&lt;/a&gt;Virtual Arrays&lt;/h3&gt;&lt;p&gt;I mentioned Virtual Scrolling above as one way to reduce the rendering time. By combining this with a concept I refer to as Virtual Arrays, you can similarly only retrieve the data the user can see, further reducing the perceived time to render.&lt;/p&gt;
&lt;p&gt;A Virtual Array is an object that looks like an array from an API perspective, but the implementation uses the database as the storage location. You can either retrieve the data from the database whenever it is requested from the array or memoize it so that it is only retrieved once.&lt;/p&gt;
&lt;h2 id=&#34;Memory-Management&#34;&gt;&lt;a href=&#34;#Memory-Management&#34; class=&#34;headerlink&#34; title=&#34;Memory Management&#34;&gt;&lt;/a&gt;Memory Management&lt;/h2&gt;&lt;p&gt;When most people think of performance, they immediately think of “how to impact the performance of good code.” But the most overlooked performance issue in JavaScript generally is memory. Specifically memory leaks.&lt;/p&gt;
&lt;p&gt;There are now several tools available for detecting and tracking down memory leaks. Find one and use it.&lt;/p&gt;
&lt;h2 id=&#34;Micro-Tweaks&#34;&gt;&lt;a href=&#34;#Micro-Tweaks&#34; class=&#34;headerlink&#34; title=&#34;Micro Tweaks&#34;&gt;&lt;/a&gt;Micro Tweaks&lt;/h2&gt;&lt;h2 id=&#34;Avoid-Iterators&#34;&gt;&lt;a href=&#34;#Avoid-Iterators&#34; class=&#34;headerlink&#34; title=&#34;Avoid Iterators&#34;&gt;&lt;/a&gt;Avoid Iterators&lt;/h2&gt;&lt;p&gt;As a general rule, using forEach, for&amp;#x2F;of, Array.map, Array.forEach, etc is slower than using for&amp;#x2F;next because all but the for&amp;#x2F;next loop uses the iterator under the hood which has a significant cost. If you know your loop is going to be small, it probably doesn’t matter but if you are iterating over a large array, you should consider using for&amp;#x2F;next instead.&lt;/p&gt;
&lt;p&gt;I’ve created a forNext() function that takes an array and a callback function so that I still enjoy the benefits of forEach without the cost of using the iterator.&lt;/p&gt;
&lt;p&gt;For an extra (micro) performance boost, you should make the callback function a standard, named, function instead of an anonymous or fat arrow function.&lt;/p&gt;
&lt;h2 id=&#34;Avoid-Duplicate-Work&#34;&gt;&lt;a href=&#34;#Avoid-Duplicate-Work&#34; class=&#34;headerlink&#34; title=&#34;Avoid Duplicate Work&#34;&gt;&lt;/a&gt;Avoid Duplicate Work&lt;/h2&gt;&lt;h3 id=&#34;Arrays&#34;&gt;&lt;a href=&#34;#Arrays&#34; class=&#34;headerlink&#34; title=&#34;Arrays&#34;&gt;&lt;/a&gt;Arrays&lt;/h3&gt;&lt;p&gt;One obvious place to avoid duplicate work is with the Array map, filter, reduce, etc. functions. When you use these functions chained to each other, you are creating a new array for each function in the chain.&lt;/p&gt;
&lt;p&gt;Again, this may not make a significant difference with a sort array, but it can be a significant performance hit with a large array.&lt;/p&gt;
&lt;h3 id=&#34;RxJS&#34;&gt;&lt;a href=&#34;#RxJS&#34; class=&#34;headerlink&#34; title=&#34;RxJS&#34;&gt;&lt;/a&gt;RxJS&lt;/h3&gt;&lt;p&gt;You’ll also find that you are performing more work than you need to because you are using RxJS operators such as combineLatest() incorrectly.&lt;/p&gt;
&lt;p&gt;Here’s a tip. If you are using combineLatest() to combine selectors, consider creating a selector instead. In this way, you’ll take advantage of the memoization that NgRX provides.&lt;/p&gt;
&lt;p&gt;Speaking of Selectors, avoid using factory selectors aka parameterized selectors. They can’t take advantage of memoization. Instead, make the parameter part of the state and use a normal selector. While this isn’t always possible, when you can do this, you’ll naturally take advantage of memoization and improve your performance.&lt;/p&gt;
&lt;h3 id=&#34;DevTools&#34;&gt;&lt;a href=&#34;#DevTools&#34; class=&#34;headerlink&#34; title=&#34;DevTools&#34;&gt;&lt;/a&gt;DevTools&lt;/h3&gt;&lt;p&gt;Unless you use the profiling tools that are part of the browser’s developer tools, you won’t know where your performance issues are. You can’t fix what you can’t measure.&lt;/p&gt;
&lt;p&gt;Get comfortable with the performance tools in your browser’s developer tools. They are your best friend when it comes to optimizing your application.&lt;/p&gt;
&lt;h3 id=&#34;Control-your-object’s-shape&#34;&gt;&lt;a href=&#34;#Control-your-object’s-shape&#34; class=&#34;headerlink&#34; title=&#34;Control your object’s shape&#34;&gt;&lt;/a&gt;Control your object’s shape&lt;/h3&gt;&lt;p&gt;Under the hood, every object you create generates a Class in the browser’s memory. Even object literals end up creating a Class. This is a way the browser tries to optimize your code. Great.&lt;/p&gt;
&lt;p&gt;Now the bad news. If you add a field to an object, or reorder the fields in an object, the browser has to create a new Class for that object or decide it isn’t worth it and forget about using that optimization for the object. Something as simple as using the spread operator and then putting the changed field at the end of the object can cause the browser to deoptimize the object.&lt;/p&gt;
&lt;p&gt;If you can, create your objects as classes and, when you change the object, use the class to do it so you can keep the shape of the object the same as it is being used.&lt;/p&gt;
&lt;h3 id=&#34;Service-Workers&#34;&gt;&lt;a href=&#34;#Service-Workers&#34; class=&#34;headerlink&#34; title=&#34;Service Workers&#34;&gt;&lt;/a&gt;Service Workers&lt;/h3&gt;&lt;p&gt;Similar in concept to the virtual arrays above but a standard API that you can implement globally. You can use service workers to cache data from the server and only ask the server for it again after you consider it stale.&lt;/p&gt;
&lt;p&gt;You can also use this to cache the index.html file locally, so you don’t have to retrieve it until there is a new version.&lt;/p&gt;
&lt;h3 id=&#34;WebAssembly&#34;&gt;&lt;a href=&#34;#WebAssembly&#34; class=&#34;headerlink&#34; title=&#34;WebAssembly&#34;&gt;&lt;/a&gt;WebAssembly&lt;/h3&gt;&lt;p&gt;I’ve yet to find my code is so slow that this actually makes sense, but it is theoretically possible that you’d find even more performance by creating services using WebAssembly. This would mean you’d need to write the code in something other than TypeScript and Angularize it by wrapping it in TypeScript&amp;#x2F;Angular code. But I’ve seen at least one article on the web where they did just that.&lt;/p&gt;
&lt;h3 id=&#34;WebWorkers-and-Shared-Workers&#34;&gt;&lt;a href=&#34;#WebWorkers-and-Shared-Workers&#34; class=&#34;headerlink&#34; title=&#34;WebWorkers and Shared Workers&#34;&gt;&lt;/a&gt;WebWorkers and Shared Workers&lt;/h3&gt;&lt;p&gt;This is another place where there is at least a theoretical possibility that it would provide additional performance. At the very least, it can provide the appearance of performance.&lt;/p&gt;
&lt;p&gt;Some places to consider using Shared Workers specifically are with Web Sockets and Data Retrieval. By placing Web Socket listeners in a Shared Worker, you create one connection to the server. The Shared Worker can then relay those messages to the client code on as many windows as are currently open.&lt;/p&gt;
&lt;p&gt;Similarly, by using a Shared Worker as the main place that retrieves your data, you can cache the data and rebroadcast the new data to all the open browser windows listening to the Shared Worker.&lt;/p&gt;
&lt;h2 id=&#34;Server-Side-Considerations&#34;&gt;&lt;a href=&#34;#Server-Side-Considerations&#34; class=&#34;headerlink&#34; title=&#34;Server Side Considerations&#34;&gt;&lt;/a&gt;Server Side Considerations&lt;/h2&gt;&lt;h3 id=&#34;Normalization-is-a-Curse-Here-Too&#34;&gt;&lt;a href=&#34;#Normalization-is-a-Curse-Here-Too&#34; class=&#34;headerlink&#34; title=&#34;Normalization is a Curse Here Too&#34;&gt;&lt;/a&gt;Normalization is a Curse Here Too&lt;/h3&gt;&lt;p&gt;I once worked on an application where the data was being retrieved from 20 tables joined together. When we looked at what was going on, we realized that most of that data was static when the client was using it and that we could dump most of the join results into a flat table and use it instead. This was another case where we went from an 8-second load time to 1 second.&lt;/p&gt;
&lt;p&gt;The performance considerations around JOINs vary depending on what database you are using. But it is something to keep in mind all the same.&lt;/p&gt;
&lt;h3 id=&#34;Server-Side-Caching&#34;&gt;&lt;a href=&#34;#Server-Side-Caching&#34; class=&#34;headerlink&#34; title=&#34;Server Side Caching&#34;&gt;&lt;/a&gt;Server Side Caching&lt;/h3&gt;&lt;p&gt;In many systems similar to the one I mentioned above, most of our calls to the server could be considered Functionally pure enough that we could cache the data.&lt;/p&gt;
&lt;p&gt;I &lt;a href=&#34;/what%E2%80%99s-the-truth-about-running-asp-net-webapi-asynchronously/&#34;&gt;did some timings on this several years ago&lt;/a&gt; and the results, even caching for a second, gave some pretty impressive results.&lt;/p&gt;
&lt;p&gt;For example, those lookup tables I discussed earlier don’t need to be retrieved from the database every time we make a call for them. We should be able to make a call for the data once and then return that data every time it is requested until the data is refreshed.&lt;/p&gt;
&lt;h2 id=&#34;Conclusion&#34;&gt;&lt;a href=&#34;#Conclusion&#34; class=&#34;headerlink&#34; title=&#34;Conclusion&#34;&gt;&lt;/a&gt;Conclusion&lt;/h2&gt;&lt;p&gt;There are probably other ways to optimize your application that I’ve forgotten or, more likely, do out of habit now.&lt;/p&gt;
&lt;p&gt;What I’ve written about above are the ones that stand out as the often overlooked issues.&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://davembush.github.com/ngzones-performance-impact/</guid>
            <title>NgZones Performance Impact</title>
            <link>http://davembush.github.com/ngzones-performance-impact/</link>
            <category>angular</category>
            <category>performance</category>
            <category>change-detection</category>
            <pubDate>Sat, 28 May 2022 19:03:40 -0400</pubDate>
            <description><![CDATA[ &lt;p&gt;I’ve been working on this article for a month, off and on. When I started, I set out to demonstrate the performance impact of change detection in Angular. In particular, I wanted to demonstrate that turning zones off would have a significant impact on performance even if you followed all my other advice regarding performance optimization.&lt;/p&gt;
&lt;p&gt;That is, if you had:&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;ul&gt;
&lt;li&gt;Implement OnPush notification&lt;/li&gt;
&lt;li&gt;Keep your components small&lt;/li&gt;
&lt;li&gt;Use pure pipes&lt;/li&gt;
&lt;li&gt;Use NgRX Selectors&lt;/li&gt;
&lt;li&gt;Use distinctUntilChanged on your Observables&lt;/li&gt;
&lt;li&gt;Don’t bind to computed values.&lt;/li&gt;
&lt;li&gt;User RxJS distinct()&lt;/li&gt;
&lt;li&gt;Use RxJS replay()&lt;/li&gt;
&lt;li&gt;Style the :host&lt;/li&gt;
&lt;li&gt;Use TrackBy x in ngFor&lt;/li&gt;
&lt;li&gt;Lazy-load routes&lt;/li&gt;
&lt;li&gt;Preload lazy-loaded routes&lt;/li&gt;
&lt;li&gt;Lazy-load resources&lt;/li&gt;
&lt;li&gt;Use virtual scrolling&lt;/li&gt;
&lt;li&gt;Don’t use nested data in your store&lt;/li&gt;
&lt;li&gt;Pre-load lookup tables.&lt;/li&gt;
&lt;li&gt;Use virtual arrays&lt;/li&gt;
&lt;li&gt;Tune your server&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Once you’ve done all those things, the only question left is “exactly how much time does the change detection cycle take if nothing has changed?”&lt;/p&gt;
&lt;h2 id=&#34;First-Attempts&#34;&gt;&lt;a href=&#34;#First-Attempts&#34; class=&#34;headerlink&#34; title=&#34;First Attempts&#34;&gt;&lt;/a&gt;First Attempts&lt;/h2&gt;&lt;p&gt;Assuming that change detection would be an issue, I set out to determine how much of a performance impact I would see with some pretty simple code.  So I created a component that updated a value when a button was clicked.&lt;/p&gt;
&lt;p&gt;I then used the performance tools in developer tools to see just how long the update cycle would take.&lt;/p&gt;
&lt;p&gt;At first I thought I was on to something, but it was actually the compiler kicking in on the first run. When I clicked the button a second time, the performance was not any different regardless of where I put the changes.&lt;/p&gt;
&lt;p&gt;I thought maybe the difference was the number of @Inputs that were being watched, but even updating all those did not make any significant difference.  Even using prop drilling, if the component didn’t actually use the value from the @Input() there was no difference in performance.&lt;/p&gt;
&lt;h2 id=&#34;How-Much-Time-Does-ChangeDetection-Take&#34;&gt;&lt;a href=&#34;#How-Much-Time-Does-ChangeDetection-Take&#34; class=&#34;headerlink&#34; title=&#34;How Much Time Does ChangeDetection Take?&#34;&gt;&lt;/a&gt;How Much Time Does ChangeDetection Take?&lt;/h2&gt;&lt;p&gt;So, today I set out to see just how much time change detection takes if nothing updates in the app.  Just trigger a change detection cycle.&lt;/p&gt;
&lt;p&gt;That’s easy, create a button that you can click nested in the inner most component.&lt;/p&gt;
&lt;p&gt;To get a better sense of timing I also created a tree of components 1000 levels deep.&lt;/p&gt;
&lt;p&gt;The entire click event where the change detection cycle occurs take about 20ms with the developer tools CPU performance set to 4x.&lt;/p&gt;
&lt;h2 id=&#34;Conclusion&#34;&gt;&lt;a href=&#34;#Conclusion&#34; class=&#34;headerlink&#34; title=&#34;Conclusion&#34;&gt;&lt;/a&gt;Conclusion&lt;/h2&gt;&lt;p&gt;If you are turning off zones as THE way of optimizing your performance you are masking architectural issues that should have been addressed first. Don’t let anyone tell you otherwise. It just isn’t true. Take it from someone who tried to prove it was.&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://davembush.github.com/3-javascript-fallacies-you-might-believe/</guid>
            <title>3 JavaScript Fallacies You Might Believe</title>
            <link>http://davembush.github.com/3-javascript-fallacies-you-might-believe/</link>
            <category>angular</category>
            <category>javascript</category>
            <category>performance</category>
            <category>react.js</category>
            <pubDate>Tue, 14 Mar 2017 07:30:00 -0400</pubDate>
            <description><![CDATA[ &lt;p&gt;You know, you think the whole world knows something is true until you hear someone people respect say something really dumb.  The three JavaScript fallacies I have here are actual statements I’ve heard over the last week during a discussion about Angular2 and Rect.  What makes these fallacies particularly interesting is that they sound plausible.  In fact, there are time when they are even true.  But in the larger context of a JavaScript application they are nearly always false.&lt;/p&gt;
&lt;p&gt;So, here are 3 JavaScript Fallacies you may still believe that you may want to reevaluate.&lt;/p&gt;
&lt;figure&gt;![](/uploads/2017/03/image-2.png &#34;3 JavaScript Fallacies You Might Believe&#34;)&lt;figcaption&gt;Photo credit: [bark](//www.flickr.com/photos/barkbud/4341791754/) via [VisualHunt](//visualhunt.com/re/8dc251) / [ CC BY](//creativecommons.org/licenses/by/2.0/)&lt;/figcaption&gt;&lt;/figure&gt;

&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;Direct-Access-to-the-DOM-is-Faster-than-using-a-Virtual-DOM&#34;&gt;&lt;a href=&#34;#Direct-Access-to-the-DOM-is-Faster-than-using-a-Virtual-DOM&#34; class=&#34;headerlink&#34; title=&#34;Direct Access to the DOM is Faster than using a Virtual DOM&#34;&gt;&lt;/a&gt;Direct Access to the DOM is Faster than using a Virtual DOM&lt;/h2&gt;&lt;p&gt;OK. I will grant that if you only ever want to change one thing on the screen at a time, yes accessing the DOM directly from JavaScript is probably going to be faster than going through some kind of Virtual DOM layer as is common in React, Angular2 and several other libraries and frameworks that are available today.&lt;/p&gt;
&lt;p&gt;But, the fact is, that’s not how most code works. If you are writing this kind of application and you are using a library or framework that uses a virtual DOM layer, something is wrong. I would argue you’ve probably chosen the wrong library for what you are trying to do.&lt;/p&gt;
&lt;p&gt;But, let’s assume that you are writing a typical SPA application that doesn’t just update one area of the screen. In this case, the fastest way to make this update is all at once. One call to the DOM from JavaScript. I’ve written before about how &lt;a href=&#34;/javascript-performance-tweaks/&#34;&gt;slow accessing the DOM is&lt;/a&gt;. And for all the performance enhancements since I wrote that article, accessing the DOM is still one of the slowest things you can do. So, a framework that lets you write your code in a way similar to how you would write to the DOM directly, but lets you do this in a way that doesn’t actually write to the DOM until the last minute is FASTER than writing to the DOM directly.&lt;/p&gt;
&lt;h2 id=&#34;Immutable-Objects-are-Necessarily-Slower-than-Mutable-Objects&#34;&gt;&lt;a href=&#34;#Immutable-Objects-are-Necessarily-Slower-than-Mutable-Objects&#34; class=&#34;headerlink&#34; title=&#34;Immutable Objects are Necessarily Slower than Mutable Objects&#34;&gt;&lt;/a&gt;Immutable Objects are Necessarily Slower than Mutable Objects&lt;/h2&gt;&lt;p&gt;Functional JavaScript programming has become the latest cool new buzzword in the JavaScript community, for a lot of good reasons, but one main concept that comes along for the ride is the idea of making all of our object immutable. This means, for example, that if I want to modify an array, instead of changing the current array, I would create a new array and copy the elements and the new element into it. No more push.&lt;/p&gt;
&lt;p&gt;Similarly, for a regular object that isn’t a list, we would create a new object and copy the existing elements into it and then overwrite the items that have changed.&lt;/p&gt;
&lt;h3 id=&#34;Why&#34;&gt;&lt;a href=&#34;#Why&#34; class=&#34;headerlink&#34; title=&#34;Why?&#34;&gt;&lt;/a&gt;Why?&lt;/h3&gt;&lt;p&gt;Now, why would we want to go to all of this work? It does seem like it would be faster to just modify the existing object. Right?&lt;/p&gt;
&lt;p&gt;But you see, there is this little thing called “change detection” that more than makes up for all of this overhead I just described.&lt;/p&gt;
&lt;p&gt;In most of our applications, at some point we want to know if an object has changed, right? If we can’t rely on the fact that we have a new object, we have to do a deep comparison of the two objects until we’ve determined that there is a difference, or we’ve been through the whole list and verified that the nothing has changed.&lt;/p&gt;
&lt;p&gt;Once we can rely on objects being immutable, we can use the equals operator (&amp;#x3D;&amp;#x3D;, or &amp;#x3D;&amp;#x3D;&amp;#x3D;) to see if the object has changed. I’m sure you can see that this takes much less time than evaluating an entire object tree, even if you object only has two properties in it that need to be compared.&lt;/p&gt;
&lt;h3 id=&#34;Real-Problem&#34;&gt;&lt;a href=&#34;#Real-Problem&#34; class=&#34;headerlink&#34; title=&#34;Real Problem?&#34;&gt;&lt;/a&gt;Real Problem?&lt;/h3&gt;&lt;p&gt;But let’s step back and look at the bigger picture. In most of the code that I write, what we are really talking about is immutable arrays. Yes there are other non-array places where we would use immutable objects, but my guess is that immutable objects impacts 80% of my code. Get a list of records from the database for example.&lt;/p&gt;
&lt;p&gt;The fact of the matter is, every time I access the database, I get a new array back anyhow. Even in the case of retrieving a single record, I still get a new object back.&lt;/p&gt;
&lt;p&gt;If I need to delete an element from an array, here again, I’ll end up creating a new object.&lt;/p&gt;
&lt;p&gt;In fact, except modifying a row, or adding a record to the end of a list, just about everything I tend to do with an array ends up being an immutable operation anyhow. By making everything immutable, we are forcing the areas that we aren’t already implementing immutability to be immutable. The point is, in terms of performance the net is an obvious gain both in terms of performance and in terms of consistency.&lt;/p&gt;
&lt;p&gt;And, going back to the issue of rendering our data into the DOM, because the change detection is faster, we can determine that a particular component doesn’t need to have the DOM updated quicker rather than re-rendering the entire DOM.&lt;/p&gt;
&lt;h2 id=&#34;Backwards-Compatibility-means-I-can’t-upgrade-my-Development-Environment&#34;&gt;&lt;a href=&#34;#Backwards-Compatibility-means-I-can’t-upgrade-my-Development-Environment&#34; class=&#34;headerlink&#34; title=&#34;Backwards Compatibility means I can’t upgrade my Development Environment&#34;&gt;&lt;/a&gt;Backwards Compatibility means I can’t upgrade my Development Environment&lt;/h2&gt;&lt;p&gt;Continuing on, remember the conversation I’m referencing was about React and Angular2. And the guy who was making these statements about performance was asserting that he couldn’t upgrade his React environment to use the latest and greatest tool chain because he had to support older browsers. He specifically stated IE6. Now, knowing the site he’s talking about, I doubt we make any money at all from people who run IE6. But, let’s just assume for a second that we do.&lt;/p&gt;
&lt;h3 id=&#34;So-what-you’re-telling-me-is…&#34;&gt;&lt;a href=&#34;#So-what-you’re-telling-me-is…&#34; class=&#34;headerlink&#34; title=&#34;So, what you’re telling me is…&#34;&gt;&lt;/a&gt;So, what you’re telling me is…&lt;/h3&gt;&lt;p&gt;… that you are willing to let performance suffer for 99% of your very large customer based because you need to support the 1% (I’m being generous here) of the people who have refused to upgrade and probably aren’t producing any revenue for the company? Maybe I’m missing something, but this seems rather short-sighted. That, or maybe you just don’t know that the new features in the newer browsers allow you to not just write better JavaScript but also allow you to do things without JavaScript that perform better. If you are really interested in writing fast web sites, you should be moving to the latest and greatest tool chain as often as is humanly possible.&lt;/p&gt;
&lt;h3 id=&#34;Bugs-and-Security-Risk&#34;&gt;&lt;a href=&#34;#Bugs-and-Security-Risk&#34; class=&#34;headerlink&#34; title=&#34;Bugs and Security Risk&#34;&gt;&lt;/a&gt;Bugs and Security Risk&lt;/h3&gt;&lt;p&gt;Just this last week I saw a study that said that over a third of the web sites on the Internet were running code that left them venerable to security risk. That is, the code they were running had known security risk. By not upgrading your tools for public facing sites, you are leaving your company at risk. When your site is compromised, do you want to be the one who has to explain to your boss that it is because you refused to upgrade your tools? I sure don’t.&lt;/p&gt;
&lt;h3 id=&#34;But-what-about-the-old-browsers&#34;&gt;&lt;a href=&#34;#But-what-about-the-old-browsers&#34; class=&#34;headerlink&#34; title=&#34;But what about the old browsers?&#34;&gt;&lt;/a&gt;But what about the old browsers?&lt;/h3&gt;&lt;p&gt;Well, if you really need to support the old stuff, there are polyfills that you can apply that will let you run the newer stuff in the older browsers. Seems to me you get the best of both worlds. Your customers who are up to date benefit with a better performing, and less buggy website, and the customers using older browser still get to see something. Are there places where you might still have to make some compromises. Sure. There are a few places. But not enough that you shouldn’t upgrade.&lt;/p&gt;
&lt;h2 id=&#34;What-is-the-Bigger-Problem&#34;&gt;&lt;a href=&#34;#What-is-the-Bigger-Problem&#34; class=&#34;headerlink&#34; title=&#34;What is the Bigger Problem?&#34;&gt;&lt;/a&gt;What is the Bigger Problem?&lt;/h2&gt;&lt;p&gt;So, how can this happen? How can really smart people make really bad choices like this?&lt;/p&gt;
&lt;p&gt;I don’t really know, but I have a few theories.&lt;/p&gt;
&lt;p&gt;One is just plain arrogance. Being so sure you are right that you never stop to think you might be wrong.&lt;/p&gt;
&lt;p&gt;I have to admit, when I first learned about immutability, I thought it sounded slow too. But, my thinking went along the lines of, “well, much smarter people than me are working on this, they must think it makes sense. I wonder why?” And then I started digging for answers.&lt;/p&gt;
&lt;p&gt;So, I would encourage those who are responsible for making decisions to make sure that the people they are listening to can actually back up what they are saying and not just assume they are right because they seem so confident.&lt;/p&gt;
 ]]></description>
        </item>
        <item>
            <guid isPermalink="true">http://davembush.github.com/asp-net-server-performance-testing/</guid>
            <title>ASP.NET Server Performance Testing</title>
            <link>http://davembush.github.com/asp-net-server-performance-testing/</link>
            <category>performance</category>
            <category>testing</category>
            <category>asp.net</category>
            <category>memory</category>
            <pubDate>Thu, 06 Nov 2014 06:00:00 -0500</pubDate>
            <description><![CDATA[ &lt;p&gt;This happened a couple of years ago, but it is still relevant because I know of at least one place where it is still happening even though Microsoft has fixed the issue that initially caused this hack to be put in place in the first place.&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;Problem-In-Production-–-Oh-NO&#34;&gt;&lt;a href=&#34;#Problem-In-Production-–-Oh-NO&#34; class=&#34;headerlink&#34; title=&#34;Problem In Production – Oh NO!&#34;&gt;&lt;/a&gt;Problem In Production – Oh NO!&lt;/h2&gt;&lt;p&gt;Here’s the problem we were seeing.  We had several large PDF files that the client wanted to put up on the site so that their customers could download them.  The problem that we were seeing is that even though the site worked fine under development and QA, the site seemed to consume a lot of memory under load.&lt;/p&gt;
&lt;p&gt;Another symptoms we saw was that the file download took a lot of time to start, or timed out completely.  But the main issue was the memory because when the memory was consumed, the site would restart, and because it was a worker process crash that caused it, the restart took the site down.  This is not something you want to see happen when you are working with a client with world wide exposure.  A client who, if I told you the name, I’m sure you would recognize.&lt;/p&gt;
&lt;p&gt;In fact, it was the site not responding, or crashing, that first alerted us to the problem.  So, as soon as we knew the site wasn’t responding, I’d log onto the server and fire up task manager to see what was going on.&lt;/p&gt;
&lt;h2 id=&#34;Server-Management-Tip&#34;&gt;&lt;a href=&#34;#Server-Management-Tip&#34; class=&#34;headerlink&#34; title=&#34;Server Management Tip&#34;&gt;&lt;/a&gt;Server Management Tip&lt;/h2&gt;&lt;p&gt;One of the things I did early on managing the servers, is that I set up an entirely separate app pool for each of the web sites we are hosting.  This way, we can monitor the memory and CPU activity of each one independently.  For those of you who are interested, the way to make the pool name show up in task manager is to run the pool in ApplicationPoolIdentity, a setting you can get to through “Advanced Settings…”  If you are only hosting one site, you shouldn’t need to do this, but in my case, with multiple sites, this told me a lot about what was going on with the sites and ultimately helped me track down what the problem was.&lt;/p&gt;
&lt;p&gt;By the way, you should always run each of your sites under a separate application pool so that when one site is having trouble, every site on your server doesn’t have trouble.  Imagine having an issue and not even knowing for sure which site was causing the trouble.  It’s bad enough not knowing what page is causing the problem.&lt;/p&gt;
&lt;h2 id=&#34;It-Is-a-Memory-Issue-Now-What&#34;&gt;&lt;a href=&#34;#It-Is-a-Memory-Issue-Now-What&#34; class=&#34;headerlink&#34; title=&#34;It Is a Memory Issue.  Now What?&#34;&gt;&lt;/a&gt;It Is a Memory Issue.  Now What?&lt;/h2&gt;&lt;p&gt;OK.  So, I could see the memory increasing as soon as the site came back up.  So, now to try to track down what was causing memory issues.&lt;/p&gt;
&lt;p&gt;I tried various things along the way, none of them shed any light at all on the problem.  I even got dotMemory from JetBrains to see if I could find anything.  A memory leak maybe?  No, none of my code had even a small leak.&lt;/p&gt;
&lt;h2 id=&#34;The-Fix-Discovered&#34;&gt;&lt;a href=&#34;#The-Fix-Discovered&#34; class=&#34;headerlink&#34; title=&#34;The Fix Discovered&#34;&gt;&lt;/a&gt;The Fix Discovered&lt;/h2&gt;&lt;p&gt;And then I finally stumbled on the issue.  I can’t remember what it was that we installed that needed this, but what it did was change our web.config file so that it had a section in it that looks like this:&lt;/p&gt;
&lt;figure class=&#34;highlight xml&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;configuration&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;... lots of other configuration stuff ...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;system.webServer&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;tag&#34;&gt;&amp;lt;&lt;span class=&#34;name&#34;&gt;modules&lt;/span&gt; **&lt;span class=&#34;attr&#34;&gt;runAllManagedModulesForAllRequests&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;**&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;What that causes IIS to do is to run ALL of your web request through ALL of your .NET modules.  Why is this a problem you ask?  Because it even runs all of your images, css, javascript and other static content.  This isn’t normally a huge problem because most of that stuff is relatively small. But, when you try to run a be PDF through that pipeline, you’ll run out of memory because, and this is the major issue here, because the whole file has to be loaded into memory on the server before it can be sent on to the web browser to download.&lt;/p&gt;
&lt;p&gt;Make sure that runAllManagedModulesForAllRequest is either set to false, or doesn’t exist in your web.config file.  If you need it to be turned on for some valid reason that I am not thinking of, at least put your static files on another site where this can be turned off.&lt;/p&gt;
&lt;h2 id=&#34;Moral-Of-The-Story&#34;&gt;&lt;a href=&#34;#Moral-Of-The-Story&#34; class=&#34;headerlink&#34; title=&#34;Moral Of The Story&#34;&gt;&lt;/a&gt;Moral Of The Story&lt;/h2&gt;&lt;p&gt;Now, the question that we should be asking now that we’ve figured it all out is, why wasn’t this caught earlier?  When a site goes up, isn’t all of the functionality, including all of the links to all of the images, files to download, and other pages on the site and off the site supposed to be tested?&lt;/p&gt;
&lt;p&gt;Yes, of course they are, but if you haven’t at least written down where all of this is, if you don’t have a systematic way of testing EVERYTHING, you WILL end up with these kind of errors once you put the site live.  This is to say nothing of load testing along the way.  This can all be prevented.&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
